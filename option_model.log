2025-02-11 20:21:42,849 - INFO - Starting Option Trading Model application
2025-02-12 11:34:09,224 - INFO - Application shutdown
2025-02-24 16:27:20,682 - INFO - Starting Option Trading Model application
2025-02-24 16:27:26,777 - INFO - Starting architecture benchmarking...
2025-02-24 16:28:25,444 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_TU_20250224_162737.txt
2025-02-24 16:29:16,218 - INFO - Performance metrics saved to performance_logs/GRU-GRU_TU_20250224_162825.txt
2025-02-24 16:30:18,925 - INFO - Performance metrics saved to performance_logs/LSTM-LSTM_TU_20250224_162916.txt
2025-02-24 16:30:18,927 - INFO - Architecture comparison saved to performance_logs/architecture_comparison_20250224_163018.txt
2025-02-24 16:30:20,771 - INFO - Architecture visualizations saved to performance_logs
2025-02-24 16:30:20,772 - INFO - Architecture benchmarking completed successfully
2025-02-24 16:31:14,043 - INFO - Starting architecture benchmarking...
2025-02-24 16:32:23,554 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_SLF_20250224_163120.txt
2025-02-24 16:33:32,547 - INFO - Performance metrics saved to performance_logs/GRU-GRU_SLF_20250224_163223.txt
2025-02-24 16:34:41,435 - INFO - Application terminated by user
2025-02-24 16:34:41,437 - INFO - Application shutdown
2025-02-24 16:34:46,833 - INFO - Starting Option Trading Model application
2025-02-24 16:34:49,026 - INFO - Starting architecture benchmarking...
2025-02-24 16:37:06,071 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_BAM_20250224_163514.txt
2025-02-24 16:37:44,827 - INFO - Performance metrics saved to performance_logs/GRU-GRU_BAM_20250224_163706.txt
2025-02-24 16:39:42,701 - INFO - Performance metrics saved to performance_logs/LSTM-LSTM_BAM_20250224_163744.txt
2025-02-24 16:39:42,703 - INFO - Architecture comparison saved to performance_logs/architecture_comparison_20250224_163942.txt
2025-02-24 16:39:44,509 - INFO - Architecture visualizations saved to performance_logs
2025-02-24 16:39:44,509 - INFO - Architecture benchmarking completed successfully
2025-02-24 16:41:23,701 - INFO - Application terminated by user
2025-02-24 16:41:23,701 - INFO - Application shutdown
2025-02-24 17:06:54,491 - INFO - Starting Option Trading Model application
2025-02-24 17:06:56,281 - INFO - Application terminated by user
2025-02-24 17:06:56,282 - INFO - Application shutdown
2025-02-24 17:07:02,371 - INFO - Starting Option Trading Model application
2025-02-24 17:07:10,612 - INFO - Starting architecture benchmarking...
2025-02-24 17:23:21,136 - INFO - Starting Option Trading Model application
2025-02-24 17:23:21,136 - INFO - Using CPU for training (no GPU available)
2025-02-24 17:25:12,134 - INFO - Application terminated by user
2025-02-24 17:25:12,134 - INFO - Application shutdown
2025-02-24 17:25:18,291 - INFO - Starting Option Trading Model application
2025-02-24 17:25:18,319 - INFO - Using device: mps
2025-02-24 17:25:25,039 - INFO - Starting architecture benchmarking...
2025-02-24 19:33:57,582 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_AMZN_20250224_172542.txt
2025-02-25 15:34:13,247 - INFO - Performance metrics saved to performance_logs/GRU-GRU_AMZN_20250224_193357.txt
2025-02-25 17:16:55,557 - INFO - Performance metrics saved to performance_logs/LSTM-LSTM_AMZN_20250225_153413.txt
2025-02-25 17:16:55,575 - INFO - Architecture comparison saved to performance_logs/architecture_comparison_20250225_171655.txt
2025-02-25 17:16:57,280 - INFO - Architecture visualizations saved to performance_logs
2025-02-25 17:16:57,280 - INFO - Architecture benchmarking completed successfully
2025-02-25 19:14:14,570 - INFO - Starting architecture benchmarking...
2025-02-25 19:19:19,598 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_HSBC_20250225_191436.txt
2025-02-25 19:23:24,950 - INFO - Performance metrics saved to performance_logs/GRU-GRU_HSBC_20250225_191919.txt
2025-02-25 19:27:38,725 - INFO - Performance metrics saved to performance_logs/LSTM-LSTM_HSBC_20250225_192324.txt
2025-02-25 19:27:38,727 - INFO - Architecture comparison saved to performance_logs/architecture_comparison_20250225_192738.txt
2025-02-25 19:27:40,744 - INFO - Architecture visualizations saved to performance_logs
2025-02-25 19:27:40,744 - INFO - Architecture benchmarking completed successfully
2025-02-25 19:30:24,624 - INFO - Application terminated by user
2025-02-25 19:30:24,624 - INFO - Application shutdown
2025-02-26 19:47:57,228 - INFO - Starting Option Trading Model application
2025-02-26 19:47:57,254 - INFO - Using device: mps
2025-02-26 19:48:05,642 - INFO - Architecture analysis completed
2025-02-26 19:48:19,183 - INFO - Starting architecture benchmarking...
2025-02-26 20:47:09,136 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_AMZN_20250226_194857.txt
2025-02-26 21:39:04,286 - INFO - Performance metrics saved to performance_logs/GRU-GRU_AMZN_20250226_204709.txt
2025-02-26 21:44:01,259 - INFO - Application terminated by user
2025-02-26 21:44:01,259 - INFO - Application shutdown
2025-03-01 14:28:32,987 - INFO - Starting Option Trading Model application
2025-03-01 14:28:33,014 - INFO - Using device: mps
2025-03-01 14:28:35,278 - INFO - Starting architecture benchmarking...
2025-03-01 14:35:26,800 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_VALE_20250301_142905.txt
2025-03-01 14:41:51,924 - INFO - Performance metrics saved to performance_logs/GRU-GRU_VALE_20250301_143526.txt
2025-03-01 14:49:50,755 - INFO - Performance metrics saved to performance_logs/LSTM-LSTM_VALE_20250301_144151.txt
2025-03-01 14:49:50,757 - INFO - Architecture comparison saved to performance_logs/architecture_comparison_20250301_144950.txt
2025-03-01 14:49:53,031 - INFO - Architecture visualizations saved to performance_logs
2025-03-01 14:49:53,031 - INFO - Architecture benchmarking completed successfully
2025-03-01 14:59:33,103 - INFO - Application terminated by user
2025-03-01 14:59:33,104 - INFO - Application shutdown
2025-03-04 20:10:21,888 - INFO - Starting Option Trading Model application
2025-03-04 20:10:21,917 - INFO - Using device: mps
2025-03-04 20:10:30,623 - INFO - Starting architecture benchmarking...
2025-03-04 20:28:49,953 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_AAPL_20250304_201050.txt
2025-03-04 20:47:44,893 - INFO - Performance metrics saved to performance_logs/GRU-GRU_AAPL_20250304_202849.txt
2025-03-04 21:08:20,652 - INFO - Performance metrics saved to performance_logs/LSTM-LSTM_AAPL_20250304_204744.txt
2025-03-04 21:08:20,658 - INFO - Architecture comparison saved to performance_logs/architecture_comparison_20250304_210820.txt
2025-03-04 21:08:22,482 - INFO - Architecture visualizations saved to performance_logs
2025-03-04 21:08:22,482 - INFO - Architecture benchmarking completed successfully
2025-03-04 21:09:20,419 - INFO - Starting architecture benchmarking...
2025-03-04 23:36:57,712 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_AMZN_20250304_210933.txt
2025-03-04 23:52:39,736 - INFO - Starting Option Trading Model application
2025-03-04 23:52:39,764 - INFO - Using device: mps
2025-03-04 23:52:45,452 - INFO - Architecture analysis completed
2025-03-04 23:53:30,582 - INFO - Starting model training...
2025-03-04 23:53:46,384 - ERROR - Error during model training: could not convert string to float: 'AMZN220218C01760000'
2025-03-04 23:54:24,108 - INFO - Application terminated by user
2025-03-04 23:54:24,108 - INFO - Application shutdown
2025-03-04 23:55:01,487 - INFO - Starting Option Trading Model application
2025-03-04 23:55:01,508 - INFO - Using device: mps
2025-03-04 23:55:02,924 - INFO - Starting model training...
2025-03-04 23:58:43,497 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_BMO_20250304_235514.txt
2025-03-04 23:58:43,887 - INFO - Model training completed successfully
2025-03-04 23:59:29,073 - INFO - Starting model training...
2025-03-05 01:30:19,356 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_AMZN_20250304_235950.txt
2025-03-05 01:30:19,723 - INFO - Model training completed successfully
2025-03-05 02:40:32,603 - INFO - Application terminated by user
2025-03-05 02:40:32,603 - INFO - Application shutdown
2025-03-05 02:40:35,780 - INFO - Starting Option Trading Model application
2025-03-05 02:40:35,801 - INFO - Using device: mps
2025-03-05 02:40:37,116 - INFO - Starting model training...
2025-03-05 02:44:28,603 - ERROR - Error during model training: Insufficient data for sequence creation!
2025-03-05 02:46:02,400 - INFO - Application terminated by user
2025-03-05 02:46:02,401 - INFO - Application shutdown
2025-03-05 02:46:07,490 - INFO - Starting Option Trading Model application
2025-03-05 02:46:07,512 - INFO - Using device: mps
2025-03-05 02:46:10,498 - INFO - Application terminated by user
2025-03-05 02:46:10,499 - INFO - Application shutdown
2025-03-05 02:46:14,978 - INFO - Starting Option Trading Model application
2025-03-05 02:46:14,998 - INFO - Using device: mps
2025-03-05 02:46:21,476 - INFO - Starting model training...
2025-03-05 02:50:59,933 - INFO - Starting Option Trading Model application
2025-03-05 02:50:59,955 - INFO - Using device: mps
2025-03-05 02:51:02,818 - INFO - Starting model training...
2025-03-05 02:52:36,321 - INFO - Starting model training...
2025-03-05 02:58:09,899 - ERROR - Error during model training: Insufficient data for sequence creation!
2025-03-05 19:02:52,376 - INFO - Application terminated by user
2025-03-05 19:02:52,377 - INFO - Application shutdown
2025-03-05 19:02:57,192 - INFO - Starting Option Trading Model application
2025-03-05 19:02:57,218 - INFO - Using device: mps
2025-03-05 19:02:58,952 - INFO - Starting model training...
2025-03-05 19:05:50,650 - INFO - Starting Option Trading Model application
2025-03-05 19:05:50,675 - INFO - Using device: mps
2025-03-05 19:05:52,504 - INFO - Starting model training...
2025-03-05 19:07:00,196 - INFO - Starting Option Trading Model application
2025-03-05 19:07:00,220 - INFO - Using device: mps
2025-03-05 19:07:02,544 - INFO - Starting model training...
2025-03-05 19:25:40,712 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_AAPL_20250305_190712.txt
2025-03-05 19:25:41,205 - INFO - Model training completed successfully
2025-03-05 21:07:44,168 - INFO - Application terminated by user
2025-03-05 21:07:44,168 - INFO - Application shutdown
2025-03-05 21:07:49,409 - INFO - Starting Option Trading Model application
2025-03-05 21:07:49,435 - INFO - Using device: mps
2025-03-05 21:07:51,460 - INFO - Starting model training...
2025-03-05 22:28:38,765 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_AMZN_20250305_210810.txt
2025-03-05 22:28:39,171 - INFO - Model training completed successfully
2025-03-06 00:10:47,910 - INFO - Starting architecture benchmarking...
2025-03-06 01:47:45,339 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_TSLA_20250306_005949.txt
2025-03-06 02:18:34,710 - INFO - Performance metrics saved to performance_logs/GRU-GRU_TSLA_20250306_014745.txt
2025-03-06 02:49:42,517 - INFO - Starting Option Trading Model application
2025-03-06 02:49:42,541 - INFO - Using device: mps
2025-03-06 02:49:44,473 - INFO - Starting architecture benchmarking...
2025-03-06 03:49:58,828 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_TSLA_20250306_025015.txt
2025-03-06 04:41:08,558 - INFO - Performance metrics saved to performance_logs/GRU-GRU_TSLA_20250306_034958.txt
2025-03-06 05:26:29,253 - INFO - Performance metrics saved to performance_logs/LSTM-LSTM_TSLA_20250306_044108.txt
2025-03-06 05:26:29,268 - INFO - Architecture comparison saved to performance_logs/architecture_comparison_20250306_052629.txt
2025-03-06 05:26:31,004 - INFO - Architecture visualizations saved to performance_logs
2025-03-06 05:26:31,005 - INFO - Architecture benchmarking completed successfully
2025-03-06 14:51:27,603 - INFO - Application terminated by user
2025-03-06 14:51:27,603 - INFO - Application shutdown
2025-03-10 19:41:29,495 - INFO - Starting Option Trading Model application
2025-03-10 19:41:29,518 - INFO - Using device: mps
2025-03-10 19:41:33,220 - INFO - Starting model training...
2025-03-21 00:52:15,756 - INFO - Starting Option Trading Model application
2025-03-21 00:52:15,792 - INFO - Using device: mps
2025-03-21 00:52:22,977 - INFO - Starting architecture benchmarking...
2025-03-21 03:00:15,650 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_AMZN_20250321_010206.txt
2025-03-21 05:41:56,684 - INFO - Performance metrics saved to performance_logs/GRU-GRU_AMZN_20250321_030015.txt
2025-03-21 10:07:29,240 - INFO - Performance metrics saved to performance_logs/LSTM-LSTM_AMZN_20250321_054156.txt
2025-03-21 10:07:29,260 - INFO - Architecture comparison saved to performance_logs/architecture_comparison_20250321_100729.txt
2025-03-21 10:07:34,239 - INFO - Architecture visualizations saved to performance_logs
2025-03-21 10:07:34,239 - INFO - Architecture benchmarking completed successfully
2025-03-24 10:40:46,942 - INFO - Starting Option Trading Model application
2025-03-24 10:40:46,964 - INFO - Using device: mps
2025-03-24 10:47:17,342 - INFO - Application terminated by user
2025-03-24 10:47:17,343 - INFO - Application shutdown
2025-03-27 21:48:40,080 - INFO - Starting Option Trading Model application
2025-03-27 21:48:40,105 - INFO - Using device: mps
2025-03-27 21:49:28,578 - INFO - Running predictions with model: mixed_lstm_gru_model_target_bid-ask_trained_AMZN_0305013019.pth
2025-03-27 21:49:28,581 - ERROR - Error during model prediction: local variable 'model' referenced before assignment
2025-03-27 21:52:58,366 - INFO - Application terminated by user
2025-03-27 21:52:58,366 - INFO - Application shutdown
2025-03-27 21:53:02,302 - INFO - Starting Option Trading Model application
2025-03-27 21:53:02,325 - INFO - Using device: mps
2025-03-27 21:53:09,171 - INFO - Determining model class from name: mixed_lstm_gru_model_target_bid-ask_trained_AMZN_0305013019.pth
2025-03-27 21:53:09,171 - INFO - Selected LSTM-GRU hybrid model architecture (default)
2025-03-27 21:53:22,401 - INFO - Running predictions with model: mixed_lstm_gru_model_target_bid-ask_trained_AMZN_0305013019.pth
2025-03-27 21:53:22,402 - INFO - Running model for AMZN with 1300761 samples
2025-03-27 21:53:22,402 - INFO - Dataset features: 146, targets: 2
2025-03-27 21:53:22,402 - INFO - Loading model from: models/mixed_lstm_gru_model_target_bid-ask_trained_AMZN_0305013019.pth
2025-03-27 21:53:22,402 - INFO - Model class: HybridRNNModel
2025-03-27 21:53:22,402 - INFO - Input size: 146, Output size: 2
2025-03-27 21:53:22,402 - INFO - Creating HybridRNNModel with hidden sizes: LSTM=128, GRU=128
2025-03-27 21:53:22,417 - INFO - Loading model state dict
2025-03-27 21:53:22,424 - ERROR - Error loading model: Error(s) in loading state_dict for HybridRNNModel:
	size mismatch for input_bn.weight: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for input_bn.bias: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for input_bn.running_mean: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for input_bn.running_var: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for lstm.weight_ih_l0: copying a param with shape torch.Size([256, 218]) from checkpoint, the shape in current model is torch.Size([512, 146]).
	size mismatch for lstm.weight_hh_l0: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.weight_ih_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.weight_hh_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for mid_bn.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for gru.weight_ih_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.weight_ih_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for bn_final.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for fc1.weight: copying a param with shape torch.Size([32, 64]) from checkpoint, the shape in current model is torch.Size([64, 128]).
	size mismatch for fc1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc2.weight: copying a param with shape torch.Size([2, 32]) from checkpoint, the shape in current model is torch.Size([2, 64]).
2025-03-27 21:53:22,424 - ERROR - Error in run_existing_model: Error(s) in loading state_dict for HybridRNNModel:
	size mismatch for input_bn.weight: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for input_bn.bias: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for input_bn.running_mean: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for input_bn.running_var: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for lstm.weight_ih_l0: copying a param with shape torch.Size([256, 218]) from checkpoint, the shape in current model is torch.Size([512, 146]).
	size mismatch for lstm.weight_hh_l0: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.weight_ih_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.weight_hh_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for mid_bn.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for gru.weight_ih_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.weight_ih_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for bn_final.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for fc1.weight: copying a param with shape torch.Size([32, 64]) from checkpoint, the shape in current model is torch.Size([64, 128]).
	size mismatch for fc1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc2.weight: copying a param with shape torch.Size([2, 32]) from checkpoint, the shape in current model is torch.Size([2, 64]).
2025-03-27 21:53:22,424 - ERROR - Error during model prediction: Error(s) in loading state_dict for HybridRNNModel:
	size mismatch for input_bn.weight: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for input_bn.bias: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for input_bn.running_mean: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for input_bn.running_var: copying a param with shape torch.Size([218]) from checkpoint, the shape in current model is torch.Size([146]).
	size mismatch for lstm.weight_ih_l0: copying a param with shape torch.Size([256, 218]) from checkpoint, the shape in current model is torch.Size([512, 146]).
	size mismatch for lstm.weight_hh_l0: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.weight_ih_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.weight_hh_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for mid_bn.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for gru.weight_ih_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.weight_ih_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for bn_final.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for fc1.weight: copying a param with shape torch.Size([32, 64]) from checkpoint, the shape in current model is torch.Size([64, 128]).
	size mismatch for fc1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc2.weight: copying a param with shape torch.Size([2, 32]) from checkpoint, the shape in current model is torch.Size([2, 64]).
2025-03-27 21:54:11,246 - INFO - Application terminated by user
2025-03-27 21:54:11,246 - INFO - Application shutdown
2025-03-27 21:56:52,928 - INFO - Starting Option Trading Model application
2025-03-27 21:56:52,949 - INFO - Using device: mps
2025-03-27 21:56:55,223 - INFO - Starting model training...
2025-03-27 21:57:40,006 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_MSFT_20250327_215727.txt
2025-03-27 21:57:40,284 - INFO - Model training completed successfully
2025-03-27 21:58:06,461 - INFO - Starting model training...
2025-03-27 21:58:24,488 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_AAPL_20250327_215813.txt
2025-03-27 21:58:24,763 - INFO - Model training completed successfully
2025-03-27 22:22:47,732 - INFO - Starting model training...
2025-03-27 22:23:10,822 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_MSFT_20250327_222300.txt
2025-03-27 22:23:11,095 - INFO - Model training completed successfully
2025-03-27 22:25:15,242 - INFO - Application terminated by user
2025-03-27 22:25:15,242 - INFO - Application shutdown
2025-03-27 22:25:18,853 - INFO - Starting Option Trading Model application
2025-03-27 22:25:18,876 - INFO - Using device: mps
2025-03-27 22:25:19,608 - INFO - Starting model training...
2025-03-27 22:25:27,451 - ERROR - Error during model training: name 'EarlyStopping' is not defined
2025-03-27 22:26:50,247 - INFO - Application terminated by user
2025-03-27 22:26:50,248 - INFO - Application shutdown
2025-03-27 22:27:44,203 - INFO - Starting Option Trading Model application
2025-03-27 22:27:44,224 - INFO - Using device: mps
2025-03-27 22:27:46,875 - INFO - Starting model training...
2025-03-27 22:31:02,753 - ERROR - Error during model training: 'torch.device' object has no attribute 'startswith'
2025-03-27 22:32:24,139 - INFO - Application terminated by user
2025-03-27 22:32:24,139 - INFO - Application shutdown
2025-03-27 22:32:30,060 - INFO - Starting Option Trading Model application
2025-03-27 22:32:30,082 - INFO - Using device: mps
2025-03-27 22:32:32,624 - INFO - Starting model training...
2025-03-27 22:33:28,908 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_IMO_20250327_223242.txt
2025-03-27 22:33:29,235 - INFO - Model training completed successfully
2025-03-27 22:37:15,819 - INFO - Starting model training...
2025-03-27 23:29:45,479 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_AAPL_20250327_223726.txt
2025-03-27 23:29:45,752 - INFO - Model training completed successfully
2025-03-27 23:45:40,263 - INFO - Determining model class from name: mixed_lstm_gru_model_target_bid-ask_trained_AAPL_0327232945.pth
2025-03-27 23:45:40,263 - INFO - Selected LSTM-GRU hybrid model architecture (default)
2025-03-27 23:45:49,326 - INFO - Running predictions with model: mixed_lstm_gru_model_target_bid-ask_trained_AAPL_0327232945.pth
2025-03-27 23:45:49,326 - INFO - Running model for AAPL with 362888 samples
2025-03-27 23:45:49,326 - INFO - Dataset features: 146, targets: 2
2025-03-27 23:45:49,326 - INFO - Loading model from: models/mixed_lstm_gru_model_target_bid-ask_trained_AAPL_0327232945.pth
2025-03-27 23:45:49,326 - INFO - Model class: HybridRNNModel
2025-03-27 23:45:49,326 - INFO - Input size: 146, Output size: 2
2025-03-27 23:45:49,326 - INFO - Creating HybridRNNModel with hidden sizes: LSTM=128, GRU=128
2025-03-27 23:45:49,328 - INFO - Loading model state dict
2025-03-27 23:45:49,333 - ERROR - Error loading model: Error(s) in loading state_dict for HybridRNNModel:
	size mismatch for lstm.weight_ih_l0: copying a param with shape torch.Size([256, 146]) from checkpoint, the shape in current model is torch.Size([512, 146]).
	size mismatch for lstm.weight_hh_l0: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.weight_ih_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.weight_hh_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for mid_bn.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for gru.weight_ih_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.weight_ih_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for bn_final.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for fc1.weight: copying a param with shape torch.Size([32, 64]) from checkpoint, the shape in current model is torch.Size([64, 128]).
	size mismatch for fc1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc2.weight: copying a param with shape torch.Size([2, 32]) from checkpoint, the shape in current model is torch.Size([2, 64]).
2025-03-27 23:45:49,333 - ERROR - Error in run_existing_model: Error(s) in loading state_dict for HybridRNNModel:
	size mismatch for lstm.weight_ih_l0: copying a param with shape torch.Size([256, 146]) from checkpoint, the shape in current model is torch.Size([512, 146]).
	size mismatch for lstm.weight_hh_l0: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.weight_ih_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.weight_hh_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for mid_bn.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for gru.weight_ih_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.weight_ih_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for bn_final.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for fc1.weight: copying a param with shape torch.Size([32, 64]) from checkpoint, the shape in current model is torch.Size([64, 128]).
	size mismatch for fc1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc2.weight: copying a param with shape torch.Size([2, 32]) from checkpoint, the shape in current model is torch.Size([2, 64]).
2025-03-27 23:45:49,333 - ERROR - Error during model prediction: Error(s) in loading state_dict for HybridRNNModel:
	size mismatch for lstm.weight_ih_l0: copying a param with shape torch.Size([256, 146]) from checkpoint, the shape in current model is torch.Size([512, 146]).
	size mismatch for lstm.weight_hh_l0: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l0: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.weight_ih_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.weight_hh_l1: copying a param with shape torch.Size([256, 64]) from checkpoint, the shape in current model is torch.Size([512, 128]).
	size mismatch for lstm.bias_ih_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for lstm.bias_hh_l1: copying a param with shape torch.Size([256]) from checkpoint, the shape in current model is torch.Size([512]).
	size mismatch for mid_bn.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for mid_bn.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for gru.weight_ih_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l0: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l0: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.weight_ih_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.weight_hh_l1: copying a param with shape torch.Size([192, 64]) from checkpoint, the shape in current model is torch.Size([384, 128]).
	size mismatch for gru.bias_ih_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for gru.bias_hh_l1: copying a param with shape torch.Size([192]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for bn_final.weight: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_mean: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for bn_final.running_var: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for fc1.weight: copying a param with shape torch.Size([32, 64]) from checkpoint, the shape in current model is torch.Size([64, 128]).
	size mismatch for fc1.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([64]).
	size mismatch for fc2.weight: copying a param with shape torch.Size([2, 32]) from checkpoint, the shape in current model is torch.Size([2, 64]).
2025-03-27 23:48:09,483 - INFO - Application terminated by user
2025-03-27 23:48:09,484 - INFO - Application shutdown
2025-03-27 23:48:14,496 - INFO - Starting Option Trading Model application
2025-03-27 23:48:14,520 - INFO - Using device: mps
2025-03-27 23:48:20,704 - INFO - Determining model class from name: mixed_lstm_gru_model_target_bid-ask_trained_AAPL_0327232945.pth
2025-03-27 23:48:20,704 - INFO - Selected LSTM-GRU hybrid model architecture (default)
2025-03-27 23:48:23,514 - INFO - Running predictions with model: mixed_lstm_gru_model_target_bid-ask_trained_AAPL_0327232945.pth
2025-03-27 23:48:23,515 - INFO - Running model for AAPL with 362888 samples
2025-03-27 23:48:23,515 - INFO - Dataset features: 146, targets: 2
2025-03-27 23:48:23,515 - INFO - Loading model from: models/mixed_lstm_gru_model_target_bid-ask_trained_AAPL_0327232945.pth
2025-03-27 23:48:23,515 - INFO - Model class: HybridRNNModel
2025-03-27 23:48:23,515 - INFO - Input size: 146, Output size: 2
2025-03-27 23:48:23,515 - INFO - Creating HybridRNNModel with hidden sizes: LSTM=64, GRU=64
2025-03-27 23:48:23,516 - INFO - Loading model state dict
2025-03-27 23:48:23,519 - INFO - Model loaded successfully
2025-03-27 23:48:43,859 - ERROR - Error in run_existing_model: type object 'datetime.datetime' has no attribute 'datetime'
2025-03-27 23:48:43,860 - ERROR - Error during model prediction: type object 'datetime.datetime' has no attribute 'datetime'
2025-03-28 00:01:03,274 - INFO - Application terminated by user
2025-03-28 00:01:03,276 - INFO - Application shutdown
2025-03-28 00:02:26,712 - INFO - Starting Option Trading Model application
2025-03-28 00:02:26,735 - INFO - Using device: mps
2025-03-28 00:02:31,467 - INFO - Starting model training...
2025-03-28 00:52:44,871 - INFO - Performance metrics saved to performance_logs/GRU-GRU_AAPL_20250328_000241.txt
2025-03-28 00:52:45,155 - INFO - Model training completed successfully
2025-03-28 00:53:53,497 - INFO - Starting model training...
2025-03-28 01:35:28,724 - INFO - Performance metrics saved to performance_logs/LSTM-LSTM_AAPL_20250328_005359.txt
2025-03-28 01:35:28,994 - INFO - Model training completed successfully
2025-03-28 01:44:14,043 - INFO - Starting architecture benchmarking...
2025-03-28 03:06:11,342 - INFO - Starting Option Trading Model application
2025-03-28 03:06:11,365 - INFO - Using device: mps
2025-03-28 03:06:14,990 - INFO - Starting architecture benchmarking...
2025-03-28 03:37:16,544 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_HSBC_20250328_030629.txt
2025-03-28 04:46:47,853 - INFO - Performance metrics saved to performance_logs/GRU-GRU_HSBC_20250328_033716.txt
2025-03-28 04:52:17,529 - INFO - Performance metrics saved to performance_logs/LSTM-LSTM_HSBC_20250328_044647.txt
2025-03-28 04:52:17,532 - INFO - Architecture comparison saved to performance_logs/architecture_comparison_20250328_045217.txt
2025-03-28 04:52:19,162 - INFO - Architecture visualizations saved to performance_logs
2025-03-28 04:52:19,163 - INFO - Architecture benchmarking completed successfully
2025-03-28 05:55:44,496 - INFO - Starting architecture benchmarking...
2025-03-28 20:10:49,924 - INFO - Performance metrics saved to performance_logs/LSTM-GRU Hybrid_NVDA_20250328_055638.txt
2025-03-28 21:52:00,545 - INFO - Starting Option Trading Model application
2025-03-28 21:52:00,584 - INFO - Using device: mps
2025-03-28 21:52:08,109 - INFO - Starting model training workflow...
2025-03-28 21:52:10,566 - INFO - Performance tracking enabled: True
2025-03-28 21:52:12,957 - INFO - Include Option Greeks features: True
2025-03-28 21:52:14,701 - INFO - Selected architecture: LSTM-GRU
2025-03-28 21:52:24,971 - INFO - Selected ticker: TD
2025-03-28 21:52:24,971 - INFO - Initializing dataset for TD, include_greeks=True...
2025-03-28 21:52:24,971 - INFO - Initializing StockOptionDataset for ticker: TD
2025-03-28 21:52:24,971 - INFO - Loading data from: data_files/split_data/TD_normalized.csv
2025-03-28 21:52:24,971 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-28 21:52:24,971 - INFO - Include Greeks: True
2025-03-28 21:52:24,971 - ERROR - No data file found for ticker TD at data_files/split_data/TD_normalized.csv
2025-03-28 21:52:24,971 - ERROR - Dataset file not found for TD: No data file found for ticker TD at data_files/split_data/TD_normalized.csv
2025-03-28 21:56:58,183 - INFO - Application terminated by user
2025-03-28 21:56:58,183 - INFO - Application shutdown
2025-03-28 21:57:01,587 - INFO - Starting Option Trading Model application
2025-03-28 21:57:01,609 - INFO - Using device: mps
2025-03-28 21:57:06,415 - INFO - Starting model training workflow...
2025-03-28 21:57:07,554 - INFO - Performance tracking enabled: True
2025-03-28 21:57:09,056 - INFO - Include Option Greeks features: True
2025-03-28 21:57:09,972 - INFO - Selected architecture: LSTM-GRU
2025-03-28 21:57:11,412 - INFO - Selected ticker: TD
2025-03-28 21:57:11,412 - INFO - Initializing dataset for TD, include_greeks=True...
2025-03-28 21:57:11,412 - INFO - Initializing StockOptionDataset for ticker: TD
2025-03-28 21:57:11,412 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TD_normalized.csv
2025-03-28 21:57:11,412 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-28 21:57:11,412 - INFO - Include Greeks: True
2025-03-28 21:57:11,674 - INFO - Starting rolling window feature computation...
2025-03-28 21:57:11,765 - INFO - Generated 108 rolling features.
2025-03-28 21:57:11,801 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-28 21:57:11,850 - INFO - Dropped 6069 rows due to NaNs in needed columns.
2025-03-28 21:57:11,863 - INFO - Dataset created for TD:
2025-03-28 21:57:11,863 - INFO -   Number of features (n_features): 139
2025-03-28 21:57:11,863 - INFO -   Number of targets (n_targets): 2
2025-03-28 21:57:11,863 - INFO -   Number of samples (rows after dropna): 49896
2025-03-28 21:57:11,863 - INFO -   Sequence length (seq_len): 30
2025-03-28 21:57:11,863 - INFO -   Max index for __getitem__: 49865
2025-03-28 21:57:11,868 - INFO - Number of features used in this run: 139
2025-03-28 21:57:11,869 - INFO - DataLoaders created: Train=39892, Val=4986, Test=4988 samples.
2025-03-28 21:57:11,869 - INFO - Initializing model LSTM-GRU with input_size=139, output_size=2
2025-03-28 21:57:11,869 - ERROR - An unexpected error occurred during model training: HybridRNNModel.__init__() got an unexpected keyword argument 'hidden_size_lstm1'
Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 814, in handle_train_model
    model = SelectedModelClass(
TypeError: HybridRNNModel.__init__() got an unexpected keyword argument 'hidden_size_lstm1'
2025-03-28 22:00:36,869 - INFO - Application terminated by user
2025-03-28 22:00:36,870 - INFO - Application shutdown
2025-03-28 22:00:41,036 - INFO - Starting Option Trading Model application
2025-03-28 22:00:41,056 - INFO - Using device: mps
2025-03-28 22:00:42,818 - INFO - Starting model training workflow...
2025-03-28 22:00:43,984 - INFO - Performance tracking enabled: True
2025-03-28 22:00:45,681 - INFO - Include Option Greeks features: True
2025-03-28 22:00:47,101 - INFO - Selected architecture: LSTM-GRU
2025-03-28 22:00:48,532 - INFO - Selected ticker: TD
2025-03-28 22:00:48,533 - INFO - Initializing dataset for TD, include_greeks=True...
2025-03-28 22:00:48,533 - INFO - Initializing StockOptionDataset for ticker: TD
2025-03-28 22:00:48,533 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TD_normalized.csv
2025-03-28 22:00:48,533 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-28 22:00:48,533 - INFO - Include Greeks: True
2025-03-28 22:00:48,794 - INFO - Starting rolling window feature computation...
2025-03-28 22:00:48,887 - INFO - Generated 108 rolling features.
2025-03-28 22:00:48,924 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-28 22:00:48,973 - INFO - Dropped 6069 rows due to NaNs in needed columns.
2025-03-28 22:00:48,982 - INFO - Dataset created for TD:
2025-03-28 22:00:48,983 - INFO -   Number of features (n_features): 139
2025-03-28 22:00:48,983 - INFO -   Number of targets (n_targets): 2
2025-03-28 22:00:48,983 - INFO -   Number of samples (rows after dropna): 49896
2025-03-28 22:00:48,983 - INFO -   Sequence length (seq_len): 30
2025-03-28 22:00:48,983 - INFO -   Max index for __getitem__: 49865
2025-03-28 22:00:48,989 - INFO - Number of features used in this run: 139
2025-03-28 22:00:48,990 - INFO - DataLoaders created: Train=39892, Val=4986, Test=4988 samples.
2025-03-28 22:00:48,990 - INFO - Initializing model LSTM-GRU with input_size=139, output_size=2
2025-03-28 22:00:49,018 - INFO - Analyzing model architecture...
2025-03-28 22:00:49,027 - ERROR - An unexpected error occurred during model training: Placeholder storage has not been allocated on MPS device!
Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 832, in handle_train_model
    model_analysis = analyze_model_architecture(
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 84, in analyze_model_architecture
    _ = model(dummy_input)
  File "/opt/homebrew/anaconda3/envs/tf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/homebrew/anaconda3/envs/tf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/bekheet/dev/option-ml-prediction/src/nn.py", line 54, in forward
    x = self.input_bn(x)
  File "/opt/homebrew/anaconda3/envs/tf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/homebrew/anaconda3/envs/tf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1844, in _call_impl
    return inner()
  File "/opt/homebrew/anaconda3/envs/tf/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1790, in inner
    result = forward_call(*args, **kwargs)
  File "/opt/homebrew/anaconda3/envs/tf/lib/python3.10/site-packages/torch/nn/modules/batchnorm.py", line 193, in forward
    return F.batch_norm(
  File "/opt/homebrew/anaconda3/envs/tf/lib/python3.10/site-packages/torch/nn/functional.py", line 2812, in batch_norm
    return torch.batch_norm(
RuntimeError: Placeholder storage has not been allocated on MPS device!
2025-03-28 22:02:52,230 - INFO - Application terminated by user
2025-03-28 22:02:52,231 - INFO - Application shutdown
2025-03-28 22:03:02,534 - INFO - Starting Option Trading Model application
2025-03-28 22:03:02,555 - INFO - Using device: mps
2025-03-28 22:03:05,678 - INFO - Starting model training workflow...
2025-03-28 22:03:06,692 - INFO - Performance tracking enabled: True
2025-03-28 22:03:07,345 - INFO - Include Option Greeks features: True
2025-03-28 22:03:08,459 - INFO - Selected architecture: LSTM-GRU
2025-03-28 22:03:09,827 - INFO - Selected ticker: TD
2025-03-28 22:03:09,828 - INFO - Initializing dataset for TD, include_greeks=True...
2025-03-28 22:03:09,828 - INFO - Initializing StockOptionDataset for ticker: TD
2025-03-28 22:03:09,828 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TD_normalized.csv
2025-03-28 22:03:09,828 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-28 22:03:09,828 - INFO - Include Greeks: True
2025-03-28 22:03:10,131 - INFO - Starting rolling window feature computation...
2025-03-28 22:03:10,226 - INFO - Generated 108 rolling features.
2025-03-28 22:03:10,266 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-28 22:03:10,314 - INFO - Dropped 6069 rows due to NaNs in needed columns.
2025-03-28 22:03:10,326 - INFO - Dataset created for TD:
2025-03-28 22:03:10,326 - INFO -   Number of features (n_features): 139
2025-03-28 22:03:10,326 - INFO -   Number of targets (n_targets): 2
2025-03-28 22:03:10,326 - INFO -   Number of samples (rows after dropna): 49896
2025-03-28 22:03:10,326 - INFO -   Sequence length (seq_len): 30
2025-03-28 22:03:10,326 - INFO -   Max index for __getitem__: 49865
2025-03-28 22:03:10,331 - INFO - Number of features used in this run: 139
2025-03-28 22:03:10,332 - INFO - DataLoaders created: Train=39892, Val=4986, Test=4988 samples.
2025-03-28 22:03:10,332 - INFO - Initializing model LSTM-GRU with input_size=139, output_size=2
2025-03-28 22:03:10,345 - INFO - Analyzing model architecture...
2025-03-28 22:03:10,345 - INFO - Analyzing architecture on device: mps:0
2025-03-28 22:03:10,517 - INFO - Model analysis complete: Total Params=138360
2025-03-28 22:03:10,518 - INFO - Starting training with performance tracking...
2025-03-28 22:03:10,518 - INFO - Initiating extended training with tracking for TD - LSTM-GRU
2025-03-28 22:20:16,870 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_TD_20250328_220310.txt
2025-03-28 22:20:16,870 - INFO - Extended training for TD - LSTM-GRU complete. Log: performance_logs/LSTM-GRU_TD_20250328_220310.txt
2025-03-28 22:20:16,870 - INFO - Saving model and results...
2025-03-28 22:20:18,749 - INFO - Model training workflow completed successfully.
2025-03-28 22:24:38,371 - INFO - Starting model training workflow...
2025-03-28 22:24:42,813 - INFO - Performance tracking enabled: True
2025-03-28 22:24:44,647 - INFO - Include Option Greeks features: False
2025-03-28 22:24:45,864 - INFO - Selected architecture: LSTM-GRU
2025-03-28 22:24:49,588 - INFO - Selected ticker: TD
2025-03-28 22:24:49,588 - INFO - Initializing dataset for TD, include_greeks=False...
2025-03-28 22:24:49,588 - INFO - Initializing StockOptionDataset for ticker: TD
2025-03-28 22:24:49,588 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TD_normalized.csv
2025-03-28 22:24:49,588 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-28 22:24:49,588 - INFO - Include Greeks: False
2025-03-28 22:24:49,828 - INFO - Starting rolling window feature computation...
2025-03-28 22:24:49,928 - INFO - Generated 108 rolling features.
2025-03-28 22:24:49,964 - INFO - Excluding Greek features as requested.
2025-03-28 22:24:50,023 - INFO - Dropped 6069 rows due to NaNs in needed columns.
2025-03-28 22:24:50,033 - INFO - Dataset created for TD:
2025-03-28 22:24:50,033 - INFO -   Number of features (n_features): 134
2025-03-28 22:24:50,033 - INFO -   Number of targets (n_targets): 2
2025-03-28 22:24:50,034 - INFO -   Number of samples (rows after dropna): 49896
2025-03-28 22:24:50,034 - INFO -   Sequence length (seq_len): 30
2025-03-28 22:24:50,034 - INFO -   Max index for __getitem__: 49865
2025-03-28 22:24:50,038 - INFO - Number of features used in this run: 134
2025-03-28 22:24:50,039 - INFO - DataLoaders created: Train=39892, Val=4986, Test=4988 samples.
2025-03-28 22:24:50,039 - INFO - Initializing model LSTM-GRU with input_size=134, output_size=2
2025-03-28 22:24:50,050 - INFO - Analyzing model architecture...
2025-03-28 22:24:50,050 - INFO - Analyzing architecture on device: mps:0
2025-03-28 22:24:50,089 - INFO - Model analysis complete: Total Params=137070
2025-03-28 22:24:50,089 - INFO - Starting training with performance tracking...
2025-03-28 22:24:50,089 - INFO - Initiating extended training with tracking for TD - LSTM-GRU
2025-03-28 22:38:07,906 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_TD_20250328_222450.txt
2025-03-28 22:38:07,906 - INFO - Extended training for TD - LSTM-GRU complete. Log: performance_logs/LSTM-GRU_TD_20250328_222450.txt
2025-03-28 22:38:07,906 - INFO - Saving model and results...
2025-03-28 22:38:09,757 - INFO - Model training workflow completed successfully.
2025-03-28 22:42:15,133 - INFO - Application terminated by user
2025-03-28 22:42:15,133 - INFO - Application shutdown
2025-03-28 22:47:48,139 - INFO - Starting Option Trading Model application
2025-03-28 22:47:48,164 - INFO - Using device: mps
2025-03-28 22:47:50,000 - INFO - Application terminated by user
2025-03-28 22:47:50,000 - INFO - Application shutdown
2025-03-28 22:47:53,351 - INFO - Starting Option Trading Model application
2025-03-28 22:47:53,371 - INFO - Using device: mps
2025-03-28 22:47:57,281 - INFO - Starting model training workflow...
2025-03-28 22:47:59,732 - INFO - Performance tracking enabled: True
2025-03-28 22:48:01,684 - INFO - Include Option Greeks features: True
2025-03-28 22:48:03,804 - INFO - Include Rolling Window features: True
2025-03-28 22:48:05,173 - INFO - Selected architecture: LSTM-GRU
2025-03-28 22:49:14,105 - INFO - Selected ticker: BNS
2025-03-28 22:49:14,106 - INFO - Initializing dataset for BNS, include_greeks=True, include_rolling=True...
2025-03-28 22:49:14,106 - INFO - Initializing StockOptionDataset for ticker: BNS
2025-03-28 22:49:14,106 - INFO - Attempting to load data from: data_files/split_data/by_ticker/BNS_normalized.csv
2025-03-28 22:49:14,106 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-28 22:49:14,106 - INFO - Include Greeks: True
2025-03-28 22:49:14,106 - INFO - Include Rolling Features: True
2025-03-28 22:49:14,268 - INFO - Starting rolling window feature computation...
2025-03-28 22:49:14,322 - INFO - Generated 108 rolling features.
2025-03-28 22:49:14,341 - INFO - Including 108 rolling features.
2025-03-28 22:49:14,341 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-28 22:49:14,364 - INFO - Dropped 3102 rows due to NaNs.
2025-03-28 22:49:14,367 - INFO - Dataset created for BNS: Features=139, Targets=2, Samples=27022, MaxIdx=26991
2025-03-28 22:49:14,370 - INFO - Number of features used in this run: 139
2025-03-28 22:49:14,371 - INFO - DataLoaders created: Train=21593, Val=2699, Test=2700 samples.
2025-03-28 22:49:14,371 - INFO - Initializing model LSTM-GRU with input_size=139, output_size=2
2025-03-28 22:49:14,387 - INFO - Analyzing model architecture...
2025-03-28 22:49:14,387 - INFO - Analyzing architecture on device: mps:0
2025-03-28 22:49:14,521 - INFO - Model analysis complete: Total Params=138360
2025-03-28 22:49:14,522 - INFO - Starting training with performance tracking...
2025-03-28 22:49:14,522 - INFO - Initiating extended training with tracking for BNS - LSTM-GRU
2025-03-28 23:02:16,307 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_BNS_20250328_224914.txt
2025-03-28 23:02:16,308 - INFO - Extended training for BNS - LSTM-GRU complete. Log: performance_logs/LSTM-GRU_BNS_20250328_224914.txt
2025-03-28 23:02:16,308 - INFO - Saving model and results...
2025-03-28 23:02:18,011 - INFO - Model training workflow completed successfully.
2025-03-28 23:03:10,789 - INFO - Starting model training workflow...
2025-03-28 23:03:14,698 - INFO - Performance tracking enabled: True
2025-03-28 23:03:16,960 - INFO - Include Option Greeks features: True
2025-03-28 23:03:22,144 - INFO - Include Rolling Window features: False
2025-03-28 23:03:23,497 - INFO - Selected architecture: LSTM-GRU
2025-03-28 23:03:29,751 - INFO - Selected ticker: BNS
2025-03-28 23:03:29,752 - INFO - Initializing dataset for BNS, include_greeks=True, include_rolling=False...
2025-03-28 23:03:29,752 - INFO - Initializing StockOptionDataset for ticker: BNS
2025-03-28 23:03:29,752 - INFO - Attempting to load data from: data_files/split_data/by_ticker/BNS_normalized.csv
2025-03-28 23:03:29,752 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-28 23:03:29,752 - INFO - Include Greeks: True
2025-03-28 23:03:29,752 - INFO - Include Rolling Features: False
2025-03-28 23:03:29,899 - INFO - Starting rolling window feature computation...
2025-03-28 23:03:29,952 - INFO - Generated 108 rolling features.
2025-03-28 23:03:29,973 - INFO - Excluding rolling features as requested.
2025-03-28 23:03:29,973 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-28 23:03:29,997 - INFO - Dropped 3102 rows due to NaNs.
2025-03-28 23:03:29,999 - INFO - Dataset created for BNS: Features=31, Targets=2, Samples=27022, MaxIdx=26991
2025-03-28 23:03:30,002 - INFO - Number of features used in this run: 31
2025-03-28 23:03:30,002 - INFO - DataLoaders created: Train=21593, Val=2699, Test=2700 samples.
2025-03-28 23:03:30,002 - INFO - Initializing model LSTM-GRU with input_size=31, output_size=2
2025-03-28 23:03:30,013 - INFO - Analyzing model architecture...
2025-03-28 23:03:30,013 - INFO - Analyzing architecture on device: mps:0
2025-03-28 23:03:30,053 - INFO - Model analysis complete: Total Params=110496
2025-03-28 23:03:30,053 - INFO - Starting training with performance tracking...
2025-03-28 23:03:30,053 - INFO - Initiating extended training with tracking for BNS - LSTM-GRU
2025-03-28 23:09:18,953 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_BNS_20250328_230330.txt
2025-03-28 23:09:18,953 - INFO - Extended training for BNS - LSTM-GRU complete. Log: performance_logs/LSTM-GRU_BNS_20250328_230330.txt
2025-03-28 23:09:18,953 - INFO - Saving model and results...
2025-03-28 23:09:20,660 - INFO - Model training workflow completed successfully.
2025-03-28 23:09:31,055 - INFO - Starting model training workflow...
2025-03-28 23:09:32,727 - INFO - Performance tracking enabled: True
2025-03-28 23:09:34,530 - INFO - Include Option Greeks features: True
2025-03-28 23:09:40,311 - INFO - Include Rolling Window features: False
2025-03-28 23:09:41,327 - INFO - Selected architecture: LSTM-GRU
2025-03-28 23:10:12,329 - INFO - Application shutdown
2025-03-28 23:12:31,792 - INFO - Starting Option Trading Model application
2025-03-28 23:12:31,815 - INFO - Using device: mps
2025-03-28 23:13:05,222 - INFO - Starting model training workflow...
2025-03-28 23:13:06,723 - INFO - Performance tracking enabled: True
2025-03-28 23:13:09,165 - INFO - Include Option Greeks features: True
2025-03-28 23:13:11,967 - INFO - Include Rolling Window features: True
2025-03-28 23:13:13,729 - INFO - Selected architecture: LSTM-GRU
2025-03-28 23:13:16,493 - INFO - Selected ticker: GOLD
2025-03-28 23:13:16,493 - INFO - Initializing dataset for GOLD, include_greeks=True, include_rolling=True...
2025-03-28 23:13:16,493 - INFO - Initializing StockOptionDataset for ticker: GOLD
2025-03-28 23:13:16,493 - INFO - Attempting to load data from: data_files/split_data/by_ticker/GOLD_normalized.csv
2025-03-28 23:13:16,493 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-28 23:13:16,493 - INFO - Include Greeks: True
2025-03-28 23:13:16,493 - INFO - Include Rolling Features: True
2025-03-28 23:13:16,990 - INFO - Starting rolling window feature computation...
2025-03-28 23:13:17,172 - INFO - Generated 108 rolling features.
2025-03-28 23:13:17,256 - INFO - Including 108 rolling features.
2025-03-28 23:13:17,256 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-28 23:13:17,352 - INFO - Dropped 7632 rows due to NaNs.
2025-03-28 23:13:17,375 - INFO - Dataset created for GOLD: Features=139, Targets=2, Samples=104109, MaxIdx=104078
2025-03-28 23:13:17,385 - INFO - Number of features used in this run: 139
2025-03-28 23:13:17,386 - INFO - DataLoaders created: Train=83263, Val=10407, Test=10409 samples.
2025-03-28 23:13:17,386 - INFO - Initializing model LSTM-GRU with input_size=139, output_size=2
2025-03-28 23:13:17,405 - INFO - Analyzing model architecture...
2025-03-28 23:13:17,405 - INFO - Analyzing architecture on device: mps:0
2025-03-28 23:13:17,528 - INFO - Model analysis complete: Total Params=138360
2025-03-28 23:13:17,529 - INFO - Starting training with performance tracking...
2025-03-28 23:13:17,529 - INFO - Initiating extended training with tracking for GOLD - LSTM-GRU
2025-03-28 23:35:30,594 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_GOLD_20250328_231317.txt
2025-03-28 23:35:30,594 - INFO - Extended training for GOLD - LSTM-GRU complete. Log: performance_logs/LSTM-GRU_GOLD_20250328_231317.txt
2025-03-28 23:35:30,594 - INFO - Saving model and results...
2025-03-28 23:35:32,443 - INFO - Model training workflow completed successfully.
2025-03-28 23:35:52,139 - INFO - Application terminated by user
2025-03-28 23:35:52,139 - INFO - Application shutdown
2025-03-29 00:32:26,520 - INFO - Starting Option Trading Model application
2025-03-29 00:32:26,551 - INFO - Using device: mps
2025-03-29 00:32:30,447 - INFO - Starting model training workflow...
2025-03-29 00:32:32,523 - INFO - Performance tracking enabled: False
2025-03-29 00:32:34,477 - INFO - Include Option Greeks features: True
2025-03-29 00:32:35,640 - INFO - Include Rolling Window features: True
2025-03-29 00:32:37,844 - INFO - Selected architecture: LSTM-GRU
2025-03-29 00:32:45,675 - INFO - Selected ticker: TU
2025-03-29 00:32:45,675 - INFO - Initializing dataset for TU, include_greeks=True, include_rolling=True...
2025-03-29 00:32:45,675 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 00:32:45,675 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 00:32:45,675 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 00:32:45,675 - INFO - Include Greeks: True
2025-03-29 00:32:45,675 - INFO - Include Rolling Features: True
2025-03-29 00:32:45,726 - INFO - Starting rolling window feature computation...
2025-03-29 00:32:45,746 - INFO - Generated 108 rolling features.
2025-03-29 00:32:45,751 - INFO - Including 108 rolling features.
2025-03-29 00:32:45,751 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 00:32:45,758 - INFO - Dropped 917 rows due to NaNs.
2025-03-29 00:32:45,759 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 00:32:45,760 - INFO - Number of features used in this run: 139
2025-03-29 00:32:45,760 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples.
2025-03-29 00:32:45,760 - INFO - Initializing model LSTM-GRU with input_size=139, output_size=2
2025-03-29 00:32:45,788 - INFO - Analyzing model architecture...
2025-03-29 00:32:45,789 - INFO - Analyzing architecture on device: mps:0
2025-03-29 00:32:45,955 - INFO - Model analysis complete: Total Params=138360
2025-03-29 00:32:45,955 - INFO - Starting standard training (no detailed log file)...
2025-03-29 00:32:45,955 - ERROR - Unexpected error: name 'nn' is not defined
Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 888, in handle_train_model
    train_losses, val_losses = train_model(model=model, train_loader=train_loader, val_loader=val_loader, epochs=config['epochs'], lr=config.get('lr', 1e-3), device=device)
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 170, in train_model
    criterion = nn.MSELoss() # type: ignore
NameError: name 'nn' is not defined
2025-03-29 00:33:08,838 - INFO - Application terminated by user
2025-03-29 00:33:08,839 - INFO - Application shutdown
2025-03-29 00:33:12,060 - INFO - Starting Option Trading Model application
2025-03-29 00:33:12,082 - INFO - Using device: mps
2025-03-29 00:33:13,248 - INFO - Starting model training workflow...
2025-03-29 00:33:15,333 - INFO - Performance tracking enabled: False
2025-03-29 00:33:16,284 - INFO - Include Option Greeks features: False
2025-03-29 00:33:17,817 - INFO - Include Rolling Window features: False
2025-03-29 00:33:18,634 - INFO - Selected architecture: LSTM-GRU
2025-03-29 00:33:19,962 - INFO - Selected ticker: TU
2025-03-29 00:33:19,962 - INFO - Initializing dataset for TU, include_greeks=False, include_rolling=False...
2025-03-29 00:33:19,962 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 00:33:19,962 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 00:33:19,962 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 00:33:19,962 - INFO - Include Greeks: False
2025-03-29 00:33:19,962 - INFO - Include Rolling Features: False
2025-03-29 00:33:20,015 - INFO - Starting rolling window feature computation...
2025-03-29 00:33:20,033 - INFO - Generated 108 rolling features.
2025-03-29 00:33:20,037 - INFO - Excluding rolling features as requested.
2025-03-29 00:33:20,037 - INFO - Excluding Greek features as requested.
2025-03-29 00:33:20,042 - INFO - Dropped 917 rows due to NaNs.
2025-03-29 00:33:20,043 - INFO - Dataset created for TU: Features=26, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 00:33:20,044 - INFO - Number of features used in this run: 26
2025-03-29 00:33:20,044 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples.
2025-03-29 00:33:20,044 - INFO - Initializing model LSTM-GRU with input_size=26, output_size=2
2025-03-29 00:33:20,061 - INFO - Analyzing model architecture...
2025-03-29 00:33:20,061 - INFO - Analyzing architecture on device: mps:0
2025-03-29 00:33:20,187 - INFO - Model analysis complete: Total Params=109206
2025-03-29 00:33:20,187 - INFO - Starting standard training (no detailed log file)...
2025-03-29 00:33:20,187 - ERROR - Unexpected error: name 'nn' is not defined
Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 888, in handle_train_model
    train_losses, val_losses = train_model(model=model, train_loader=train_loader, val_loader=val_loader, epochs=config['epochs'], lr=config.get('lr', 1e-3), device=device)
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 170, in train_model
    criterion = nn.MSELoss() # type: ignore
NameError: name 'nn' is not defined
2025-03-29 00:33:41,047 - INFO - Application terminated by user
2025-03-29 00:33:41,047 - INFO - Application shutdown
2025-03-29 00:33:44,974 - INFO - Starting Option Trading Model application
2025-03-29 00:33:44,994 - INFO - Using device: mps
2025-03-29 00:33:46,108 - INFO - Starting model training workflow...
2025-03-29 00:33:47,639 - INFO - Performance tracking enabled: False
2025-03-29 00:33:48,093 - INFO - Include Option Greeks features: False
2025-03-29 00:33:49,282 - INFO - Include Rolling Window features: False
2025-03-29 00:33:50,034 - INFO - Selected architecture: LSTM-GRU
2025-03-29 00:33:50,889 - INFO - Selected ticker: TU
2025-03-29 00:33:50,890 - INFO - Initializing dataset for TU, include_greeks=False, include_rolling=False...
2025-03-29 00:33:50,890 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 00:33:50,890 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 00:33:50,890 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 00:33:50,890 - INFO - Include Greeks: False
2025-03-29 00:33:50,890 - INFO - Include Rolling Features: False
2025-03-29 00:33:50,932 - INFO - Starting rolling window feature computation...
2025-03-29 00:33:50,952 - INFO - Generated 108 rolling features.
2025-03-29 00:33:50,956 - INFO - Excluding rolling features as requested.
2025-03-29 00:33:50,956 - INFO - Excluding Greek features as requested.
2025-03-29 00:33:50,962 - INFO - Dropped 917 rows due to NaNs.
2025-03-29 00:33:50,963 - INFO - Dataset created for TU: Features=26, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 00:33:50,963 - INFO - Number of features used in this run: 26
2025-03-29 00:33:50,964 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples.
2025-03-29 00:33:50,964 - INFO - Initializing model LSTM-GRU with input_size=26, output_size=2
2025-03-29 00:33:50,978 - INFO - Analyzing model architecture...
2025-03-29 00:33:50,978 - INFO - Analyzing architecture on device: mps:0
2025-03-29 00:33:51,102 - INFO - Model analysis complete: Total Params=109206
2025-03-29 00:33:51,102 - INFO - Starting standard training (no detailed log file)...
2025-03-29 00:33:51,102 - ERROR - Unexpected error: name 'nn' is not defined
Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 888, in handle_train_model
    train_losses, val_losses = train_model(model=model, train_loader=train_loader, val_loader=val_loader, epochs=config['epochs'], lr=config.get('lr', 1e-3), device=device)
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 170, in train_model
    criterion = nn.MSELoss()
NameError: name 'nn' is not defined
2025-03-29 00:34:30,973 - INFO - Application terminated by user
2025-03-29 00:34:30,973 - INFO - Application shutdown
2025-03-29 00:34:34,353 - INFO - Starting Option Trading Model application
2025-03-29 00:34:34,374 - INFO - Using device: mps
2025-03-29 00:34:35,533 - INFO - Starting model training workflow...
2025-03-29 00:34:36,841 - INFO - Performance tracking enabled: False
2025-03-29 00:34:37,284 - INFO - Include Option Greeks features: False
2025-03-29 00:34:37,921 - INFO - Include Rolling Window features: False
2025-03-29 00:34:38,847 - INFO - Selected architecture: LSTM-GRU
2025-03-29 00:34:40,360 - INFO - Selected ticker: TU
2025-03-29 00:34:40,360 - INFO - Initializing dataset for TU, include_greeks=False, include_rolling=False...
2025-03-29 00:34:40,360 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 00:34:40,361 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 00:34:40,361 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 00:34:40,361 - INFO - Include Greeks: False
2025-03-29 00:34:40,361 - INFO - Include Rolling Features: False
2025-03-29 00:34:40,392 - INFO - Starting rolling window feature computation...
2025-03-29 00:34:40,413 - INFO - Generated 108 rolling features.
2025-03-29 00:34:40,418 - INFO - Excluding rolling features as requested.
2025-03-29 00:34:40,418 - INFO - Excluding Greek features as requested.
2025-03-29 00:34:40,424 - INFO - Dropped 917 rows due to NaNs.
2025-03-29 00:34:40,425 - INFO - Dataset created for TU: Features=26, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 00:34:40,426 - INFO - Number of features used in this run: 26
2025-03-29 00:34:40,426 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples.
2025-03-29 00:34:40,426 - INFO - Initializing model LSTM-GRU with input_size=26, output_size=2
2025-03-29 00:34:40,439 - INFO - Analyzing model architecture...
2025-03-29 00:34:40,439 - INFO - Analyzing architecture on device: mps:0
2025-03-29 00:34:40,563 - INFO - Model analysis complete: Total Params=109206
2025-03-29 00:34:40,563 - INFO - Starting standard training (no detailed log file)...
2025-03-29 00:34:40,563 - ERROR - Unexpected error: name 'nn' is not defined
Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 888, in handle_train_model
    train_losses, val_losses = train_model(model=model, train_loader=train_loader, val_loader=val_loader, epochs=config['epochs'], lr=config.get('lr', 1e-3), device=device)
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 170, in train_model
    criterion = nn.MSELoss()
NameError: name 'nn' is not defined
2025-03-29 00:34:43,707 - INFO - Starting model training workflow...
2025-03-29 00:34:45,120 - INFO - Performance tracking enabled: True
2025-03-29 00:34:49,248 - INFO - Include Option Greeks features: True
2025-03-29 00:34:49,656 - INFO - Include Rolling Window features: True
2025-03-29 00:34:50,402 - INFO - Selected architecture: LSTM-GRU
2025-03-29 00:34:51,527 - INFO - Selected ticker: TU
2025-03-29 00:34:51,527 - INFO - Initializing dataset for TU, include_greeks=True, include_rolling=True...
2025-03-29 00:34:51,527 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 00:34:51,527 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 00:34:51,527 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 00:34:51,527 - INFO - Include Greeks: True
2025-03-29 00:34:51,528 - INFO - Include Rolling Features: True
2025-03-29 00:34:51,566 - INFO - Starting rolling window feature computation...
2025-03-29 00:34:51,587 - INFO - Generated 108 rolling features.
2025-03-29 00:34:51,592 - INFO - Including 108 rolling features.
2025-03-29 00:34:51,592 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 00:34:51,600 - INFO - Dropped 917 rows due to NaNs.
2025-03-29 00:34:51,601 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 00:34:51,602 - INFO - Number of features used in this run: 139
2025-03-29 00:34:51,602 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples.
2025-03-29 00:34:51,602 - INFO - Initializing model LSTM-GRU with input_size=139, output_size=2
2025-03-29 00:34:51,615 - INFO - Analyzing model architecture...
2025-03-29 00:34:51,615 - INFO - Analyzing architecture on device: mps:0
2025-03-29 00:34:51,655 - INFO - Model analysis complete: Total Params=138360
2025-03-29 00:34:51,655 - INFO - Starting training with performance tracking...
2025-03-29 00:34:51,655 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 00:36:04,814 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_TU_20250329_003451.txt
2025-03-29 00:36:04,814 - INFO - Extended training for TU - LSTM-GRU complete. Log: performance_logs/LSTM-GRU_TU_20250329_003451.txt
2025-03-29 00:36:04,814 - INFO - Saving model and results...
2025-03-29 00:36:06,454 - INFO - Model training workflow completed successfully.
2025-03-29 00:38:23,414 - INFO - Application terminated by user
2025-03-29 00:38:23,415 - INFO - Application shutdown
2025-03-29 01:03:50,584 - INFO - Starting Option Trading Model application
2025-03-29 01:03:50,606 - INFO - Using device: mps
2025-03-29 01:03:52,213 - INFO - Starting model training workflow...
2025-03-29 01:03:53,381 - INFO - Performance tracking enabled: True
2025-03-29 01:03:54,302 - INFO - Include Option Greeks features: True
2025-03-29 01:03:59,714 - INFO - Include Rolling Window features: False
2025-03-29 01:04:01,142 - INFO - Selected architecture: LSTM-GRU
2025-03-29 01:04:08,282 - INFO - Selected ticker: BNS
2025-03-29 01:04:08,283 - INFO - Initializing dataset for BNS, include_greeks=True, include_rolling=False...
2025-03-29 01:04:08,283 - INFO - Initializing StockOptionDataset for ticker: BNS
2025-03-29 01:04:08,283 - INFO - Attempting to load data from: data_files/split_data/by_ticker/BNS_normalized.csv
2025-03-29 01:04:08,283 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 01:04:08,283 - INFO - Include Greeks: True
2025-03-29 01:04:08,283 - INFO - Include Rolling Features: False
2025-03-29 01:04:08,439 - INFO - Starting rolling window feature computation...
2025-03-29 01:04:08,491 - INFO - Generated 108 rolling features.
2025-03-29 01:04:08,510 - INFO - Excluding rolling features as requested.
2025-03-29 01:04:08,510 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 01:04:08,537 - INFO - Dropped 3102 rows due to NaNs.
2025-03-29 01:04:08,539 - INFO - Dataset created for BNS: Features=31, Targets=2, Samples=27022, MaxIdx=26991
2025-03-29 01:04:08,542 - INFO - Number of features used in this run: 31
2025-03-29 01:04:08,543 - INFO - DataLoaders created: Train=21593, Val=2699, Test=2700 samples.
2025-03-29 01:04:08,543 - INFO - Initializing model LSTM-GRU with input_size=31, output_size=2
2025-03-29 01:04:08,555 - INFO - Analyzing model architecture...
2025-03-29 01:04:08,555 - INFO - Analyzing architecture on device: mps:0
2025-03-29 01:04:08,680 - INFO - Model analysis complete: Total Params=110496
2025-03-29 01:04:08,681 - INFO - Starting training with performance tracking...
2025-03-29 01:04:08,681 - INFO - Initiating extended training with tracking for BNS - LSTM-GRU
2025-03-29 01:09:43,911 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_BNS_20250329_010408.txt
2025-03-29 01:09:43,911 - INFO - Extended training for BNS - LSTM-GRU complete. Log: performance_logs/LSTM-GRU_BNS_20250329_010408.txt
2025-03-29 01:09:43,911 - INFO - Saving model and results...
2025-03-29 01:09:45,570 - INFO - Model training workflow completed successfully.
2025-03-29 01:37:01,052 - INFO - Starting model training workflow...
2025-03-29 01:37:02,344 - INFO - Performance tracking enabled: True
2025-03-29 01:37:03,657 - INFO - Include Option Greeks features: True
2025-03-29 01:37:08,747 - INFO - Include Rolling Window features: False
2025-03-29 01:37:14,647 - INFO - Selected architecture: LSTM-LSTM
2025-03-29 01:37:16,067 - INFO - Application shutdown
2025-03-29 01:37:20,435 - INFO - Starting Option Trading Model application
2025-03-29 01:37:20,457 - INFO - Using device: mps
2025-03-29 01:37:21,565 - INFO - Starting model training workflow...
2025-03-29 01:37:23,149 - INFO - Performance tracking enabled: True
2025-03-29 01:37:25,139 - INFO - Include Option Greeks features: False
2025-03-29 01:37:26,123 - INFO - Include Rolling Window features: False
2025-03-29 01:37:28,051 - INFO - Selected architecture: LSTM-GRU
2025-03-29 01:37:35,797 - INFO - Selected ticker: BNS
2025-03-29 01:37:35,797 - INFO - Initializing dataset for BNS, include_greeks=False, include_rolling=False...
2025-03-29 01:37:35,797 - INFO - Initializing StockOptionDataset for ticker: BNS
2025-03-29 01:37:35,797 - INFO - Attempting to load data from: data_files/split_data/by_ticker/BNS_normalized.csv
2025-03-29 01:37:35,797 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 01:37:35,797 - INFO - Include Greeks: False
2025-03-29 01:37:35,797 - INFO - Include Rolling Features: False
2025-03-29 01:37:35,951 - INFO - Starting rolling window feature computation...
2025-03-29 01:37:36,003 - INFO - Generated 108 rolling features.
2025-03-29 01:37:36,022 - INFO - Excluding rolling features as requested.
2025-03-29 01:37:36,022 - INFO - Excluding Greek features as requested.
2025-03-29 01:37:36,041 - INFO - Dropped 3102 rows due to NaNs.
2025-03-29 01:37:36,043 - INFO - Dataset created for BNS: Features=26, Targets=2, Samples=27022, MaxIdx=26991
2025-03-29 01:37:36,045 - INFO - Number of features used in this run: 26
2025-03-29 01:37:36,046 - INFO - DataLoaders created: Train=21593, Val=2699, Test=2700 samples.
2025-03-29 01:37:36,046 - INFO - Initializing model LSTM-GRU with input_size=26, output_size=2
2025-03-29 01:37:36,060 - INFO - Analyzing model architecture...
2025-03-29 01:37:36,060 - INFO - Analyzing architecture on device: mps:0
2025-03-29 01:37:36,185 - INFO - Model analysis complete: Total Params=109206
2025-03-29 01:37:36,185 - INFO - Starting training with performance tracking...
2025-03-29 01:37:36,185 - INFO - Initiating extended training with tracking for BNS - LSTM-GRU
2025-03-29 01:44:37,294 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_BNS_20250329_013736.txt
2025-03-29 01:44:37,294 - INFO - Extended training for BNS - LSTM-GRU complete. Log: performance_logs/LSTM-GRU_BNS_20250329_013736.txt
2025-03-29 01:44:37,294 - INFO - Saving model and results...
2025-03-29 01:44:38,970 - INFO - Model training workflow completed successfully.
2025-03-29 01:47:56,186 - INFO - Starting model training workflow...
2025-03-29 01:47:59,203 - INFO - Performance tracking enabled: True
2025-03-29 01:48:00,661 - INFO - Include Option Greeks features: True
2025-03-29 01:48:02,210 - INFO - Include Rolling Window features: False
2025-03-29 01:48:03,803 - INFO - Selected architecture: LSTM-GRU
2025-03-29 01:48:07,429 - INFO - Selected ticker: AMZN
2025-03-29 01:48:07,429 - INFO - Initializing dataset for AMZN, include_greeks=True, include_rolling=False...
2025-03-29 01:48:07,429 - INFO - Initializing StockOptionDataset for ticker: AMZN
2025-03-29 01:48:07,429 - INFO - Attempting to load data from: data_files/split_data/by_ticker/AMZN_normalized.csv
2025-03-29 01:48:07,429 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 01:48:07,429 - INFO - Include Greeks: True
2025-03-29 01:48:07,429 - INFO - Include Rolling Features: False
2025-03-29 01:48:13,065 - INFO - Starting rolling window feature computation...
2025-03-29 01:48:15,467 - INFO - Generated 108 rolling features.
2025-03-29 01:48:16,865 - INFO - Excluding rolling features as requested.
2025-03-29 01:48:16,865 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 01:48:18,469 - INFO - Dropped 176436 rows due to NaNs.
2025-03-29 01:48:18,537 - INFO - Dataset created for AMZN: Features=31, Targets=2, Samples=1128807, MaxIdx=1128776
2025-03-29 01:48:18,641 - INFO - Number of features used in this run: 31
2025-03-29 01:48:18,650 - INFO - DataLoaders created: Train=903021, Val=112877, Test=112879 samples.
2025-03-29 01:48:18,650 - INFO - Initializing model LSTM-GRU with input_size=31, output_size=2
2025-03-29 01:48:18,666 - INFO - Analyzing model architecture...
2025-03-29 01:48:18,667 - INFO - Analyzing architecture on device: mps:0
2025-03-29 01:48:18,708 - INFO - Model analysis complete: Total Params=110496
2025-03-29 01:48:18,708 - INFO - Starting training with performance tracking...
2025-03-29 01:48:18,708 - INFO - Initiating extended training with tracking for AMZN - LSTM-GRU
2025-03-29 02:11:50,515 - INFO - Application terminated by user
2025-03-29 02:11:50,515 - INFO - Application shutdown
2025-03-29 02:37:22,793 - INFO - Starting Option Trading Model application
2025-03-29 02:37:22,793 - INFO - Loading configuration...
2025-03-29 02:37:22,815 - INFO - Running in local environment.
2025-03-29 02:37:22,816 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 02:37:22,816 - INFO - Configuration loaded:
2025-03-29 02:37:22,816 - INFO -   seq_len: 30
2025-03-29 02:37:22,816 - INFO -   batch_size: 48
2025-03-29 02:37:22,816 - INFO -   epochs: 20
2025-03-29 02:37:22,816 - INFO -   lr: 0.001
2025-03-29 02:37:22,816 - INFO -   hidden_size_lstm: 64
2025-03-29 02:37:22,816 - INFO -   hidden_size_gru: 64
2025-03-29 02:37:22,816 - INFO -   num_layers: 2
2025-03-29 02:37:22,816 - INFO -   ticker: None
2025-03-29 02:37:22,816 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 02:37:22,816 - INFO -   device: mps
2025-03-29 02:37:22,816 - INFO -   data_dir: data_files/split_data
2025-03-29 02:37:22,816 - INFO -   models_dir: models
2025-03-29 02:37:22,816 - INFO -   performance_logs_dir: performance_logs
2025-03-29 02:37:22,816 - INFO -   viz_dir: plots
2025-03-29 02:37:22,816 - INFO - Using device: mps
2025-03-29 02:37:22,816 - INFO - Checking data directory: data_files/split_data
2025-03-29 02:37:22,816 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 02:37:22,816 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 02:37:22,816 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 02:37:22,816 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 02:37:22,816 - INFO - Validated and ensured necessary directories exist.
2025-03-29 02:37:35,452 - INFO - Starting model training workflow...
2025-03-29 02:37:37,792 - INFO - Performance tracking enabled: True
2025-03-29 02:37:39,036 - INFO - Include Option Greeks features: True
2025-03-29 02:37:40,957 - INFO - Include Rolling Window features: True
2025-03-29 02:37:46,529 - INFO - Selected architecture: LSTM-GRU
2025-03-29 02:37:49,486 - INFO - Number of epochs set to: 20
2025-03-29 02:37:56,815 - INFO - Selected ticker for training: TU
2025-03-29 02:37:56,816 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True...
2025-03-29 02:37:56,816 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 02:37:56,816 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 02:37:56,816 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 02:37:56,816 - INFO - Include Greeks: True
2025-03-29 02:37:56,816 - INFO - Include Rolling Features: True
2025-03-29 02:37:56,849 - INFO - Starting rolling window feature computation...
2025-03-29 02:37:56,865 - INFO - Generated 108 rolling features.
2025-03-29 02:37:56,869 - INFO - Including 108 rolling features.
2025-03-29 02:37:56,869 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 02:37:56,875 - INFO - Dropped 917 rows due to NaNs.
2025-03-29 02:37:56,877 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 02:37:56,878 - INFO - Number of features used: 139
2025-03-29 02:37:56,878 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples.
2025-03-29 02:37:56,878 - INFO - Initializing LSTM-GRU (In:139, Out:2, HiddenLSTM:64, HiddenGRU:64, Layers:2) on mps
2025-03-29 02:37:56,891 - INFO - Analyzing model architecture...
2025-03-29 02:37:56,891 - INFO - Analyzing architecture on device: mps:0
2025-03-29 02:37:57,020 - INFO - Model analysis complete: Total Params=138360
2025-03-29 02:37:57,020 - INFO - Starting training with performance tracking...
2025-03-29 02:37:57,021 - ERROR - Unexpected error in handle_train_model: extended_train_model_with_tracking() got an unexpected keyword argument 'performance_logs_dir'
Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 931, in handle_train_model
    model, history, log_path = extended_train_model_with_tracking(
TypeError: extended_train_model_with_tracking() got an unexpected keyword argument 'performance_logs_dir'
2025-03-29 02:43:40,020 - WARNING - Operation cancelled by KeyboardInterrupt.
2025-03-29 02:43:42,189 - INFO - Application terminated by user choice
2025-03-29 02:43:42,189 - INFO - Application shutdown sequence finished.
2025-03-29 02:43:46,805 - INFO - Starting Option Trading Model application
2025-03-29 02:43:46,805 - INFO - Loading configuration...
2025-03-29 02:43:46,826 - INFO - Running in local environment.
2025-03-29 02:43:46,827 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 02:43:46,827 - INFO - Configuration loaded:
2025-03-29 02:43:46,827 - INFO -   seq_len: 30
2025-03-29 02:43:46,827 - INFO -   batch_size: 48
2025-03-29 02:43:46,827 - INFO -   epochs: 20
2025-03-29 02:43:46,827 - INFO -   lr: 0.001
2025-03-29 02:43:46,827 - INFO -   hidden_size_lstm: 64
2025-03-29 02:43:46,827 - INFO -   hidden_size_gru: 64
2025-03-29 02:43:46,827 - INFO -   num_layers: 2
2025-03-29 02:43:46,827 - INFO -   ticker: None
2025-03-29 02:43:46,827 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 02:43:46,827 - INFO -   device: mps
2025-03-29 02:43:46,827 - INFO -   data_dir: data_files/split_data
2025-03-29 02:43:46,827 - INFO -   models_dir: models
2025-03-29 02:43:46,827 - INFO -   performance_logs_dir: performance_logs
2025-03-29 02:43:46,827 - INFO -   viz_dir: plots
2025-03-29 02:43:46,827 - INFO - Using device: mps
2025-03-29 02:43:46,827 - INFO - Checking data directory: data_files/split_data
2025-03-29 02:43:46,827 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 02:43:46,827 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 02:43:46,827 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 02:43:46,827 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 02:43:46,827 - INFO - Validated and ensured necessary directories exist.
2025-03-29 02:43:47,902 - INFO - Starting model training workflow...
2025-03-29 02:43:49,052 - INFO - Performance tracking enabled: True
2025-03-29 02:43:50,701 - INFO - Include Option Greeks features: True
2025-03-29 02:43:51,895 - INFO - Include Rolling Window features: True
2025-03-29 02:43:53,303 - INFO - Selected architecture: LSTM-GRU
2025-03-29 02:43:55,701 - INFO - Number of epochs set to: 20
2025-03-29 02:43:57,989 - INFO - Selected ticker for training: TU
2025-03-29 02:43:57,989 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True...
2025-03-29 02:43:57,989 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 02:43:57,989 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 02:43:57,989 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 02:43:57,989 - INFO - Include Greeks: True
2025-03-29 02:43:57,989 - INFO - Include Rolling Features: True
2025-03-29 02:43:58,028 - INFO - Starting rolling window feature computation...
2025-03-29 02:43:58,047 - INFO - Generated 108 rolling features.
2025-03-29 02:43:58,052 - INFO - Including 108 rolling features.
2025-03-29 02:43:58,052 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 02:43:58,058 - INFO - Dropped 917 rows due to NaNs.
2025-03-29 02:43:58,059 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 02:43:58,060 - INFO - Number of features used: 139
2025-03-29 02:43:58,060 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples.
2025-03-29 02:43:58,060 - INFO - Initializing LSTM-GRU (In:139, Out:2, HiddenLSTM:64, HiddenGRU:64, Layers:2) on mps
2025-03-29 02:43:58,075 - INFO - Analyzing model architecture...
2025-03-29 02:43:58,075 - INFO - Analyzing architecture on device: mps:0
2025-03-29 02:43:58,201 - INFO - Model analysis complete: Total Params=138360
2025-03-29 02:43:58,201 - INFO - Starting training with performance tracking...
2025-03-29 02:43:58,201 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 02:43:58,201 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 02:43:58,201 - INFO - Performance log will be saved to: performance_logs/LSTM-GRU_TU_20250329_024358.txt
2025-03-29 02:47:46,113 - INFO - Starting Option Trading Model application
2025-03-29 02:47:46,113 - INFO - Loading configuration...
2025-03-29 02:47:46,134 - INFO - Running in local environment.
2025-03-29 02:47:46,134 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 02:47:46,134 - INFO - Configuration loaded:
2025-03-29 02:47:46,134 - INFO -   seq_len: 30
2025-03-29 02:47:46,134 - INFO -   batch_size: 48
2025-03-29 02:47:46,134 - INFO -   epochs: 20
2025-03-29 02:47:46,134 - INFO -   lr: 0.001
2025-03-29 02:47:46,134 - INFO -   hidden_size_lstm: 64
2025-03-29 02:47:46,134 - INFO -   hidden_size_gru: 64
2025-03-29 02:47:46,134 - INFO -   num_layers: 2
2025-03-29 02:47:46,134 - INFO -   ticker: None
2025-03-29 02:47:46,134 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 02:47:46,134 - INFO -   device: mps
2025-03-29 02:47:46,134 - INFO -   data_dir: data_files/split_data
2025-03-29 02:47:46,134 - INFO -   models_dir: models
2025-03-29 02:47:46,134 - INFO -   performance_logs_dir: performance_logs
2025-03-29 02:47:46,134 - INFO -   viz_dir: plots
2025-03-29 02:47:46,134 - INFO - Using device: mps
2025-03-29 02:47:46,134 - INFO - Checking data directory: data_files/split_data
2025-03-29 02:47:46,134 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 02:47:46,134 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 02:47:46,134 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 02:47:46,134 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 02:47:46,134 - INFO - Validated and ensured necessary directories exist.
2025-03-29 02:47:53,711 - INFO - Starting model training workflow...
2025-03-29 02:47:55,018 - INFO - Performance tracking enabled: True
2025-03-29 02:47:56,089 - INFO - Include Option Greeks features: True
2025-03-29 02:47:56,555 - INFO - Include Rolling Window features: True
2025-03-29 02:47:58,648 - INFO - Selected architecture: LSTM-GRU
2025-03-29 02:47:59,759 - INFO - Number of epochs set to: 20
2025-03-29 02:48:01,589 - INFO - Selected ticker for training: TU
2025-03-29 02:48:01,589 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 02:48:01,589 - INFO - Attempting to load data from: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 02:48:01,589 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 02:48:01,589 - INFO - Include Greeks: True
2025-03-29 02:48:01,589 - INFO - Include Rolling Features: True
2025-03-29 02:48:01,623 - INFO - Starting rolling window feature computation...
2025-03-29 02:48:01,642 - INFO - Generated 108 rolling features.
2025-03-29 02:48:01,646 - INFO - Including 108 rolling features.
2025-03-29 02:48:01,646 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 02:48:01,652 - INFO - Dropped 917 rows due to NaNs.
2025-03-29 02:48:01,654 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 02:48:01,655 - INFO - Number of features used: 139
2025-03-29 02:48:01,655 - INFO - Using optimized DataLoader settings for MPS (num_workers=0, pin_memory=False)
2025-03-29 02:48:01,655 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples.
2025-03-29 02:48:01,655 - INFO - Initializing LSTM-GRU (In:139, Out:2, HiddenLSTM:64, HiddenGRU:64, Layers:2) on mps
2025-03-29 02:48:01,668 - INFO - Analyzing model architecture...
2025-03-29 02:48:01,669 - INFO - Analyzing architecture on device: mps:0
2025-03-29 02:48:01,795 - INFO - Model analysis complete: Total Params=138360
2025-03-29 02:48:01,795 - INFO - Starting training with performance tracking...
2025-03-29 02:48:01,795 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 02:48:01,795 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 02:48:01,795 - INFO - Performance log will be saved to: performance_logs/LSTM-GRU_TU_20250329_024801.txt
2025-03-29 02:49:32,219 - INFO - Time series plot saved to performance_logs/plots/TU_preds_ts_LSTM-GRU_20250329_024801.png
2025-03-29 02:49:32,852 - INFO - Scatter plot saved to performance_logs/plots/TU_scatter_LSTM-GRU_20250329_024801.png
2025-03-29 02:49:32,853 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_TU_20250329_024801.txt
2025-03-29 02:49:32,853 - INFO - Extended training for TU - LSTM-GRU complete. Log: performance_logs/LSTM-GRU_TU_20250329_024801.txt
2025-03-29 02:49:32,853 - INFO - Saving model and results...
2025-03-29 02:49:32,863 - INFO - Model saved to models/HybridRNN_TU_target_bid-ask_20250329_024932.pth
2025-03-29 02:49:33,150 - INFO - Training plot saved to plots/training_plot_TU_bid-ask_20250329_024932.png
2025-03-29 02:49:33,910 - INFO - Time series plot saved to plots/TU_preds_ts_20250329_024932.png
2025-03-29 02:49:34,482 - INFO - Scatter plot saved to plots/TU_scatter_20250329_024932.png
2025-03-29 02:49:34,483 - INFO - Model training workflow completed successfully.
2025-03-29 02:49:57,281 - INFO - Application terminated by user choice
2025-03-29 02:49:57,282 - INFO - Application shutdown sequence finished.
2025-03-29 03:02:25,499 - INFO - Starting Option Trading Model application
2025-03-29 03:02:25,499 - INFO - Loading configuration...
2025-03-29 03:02:25,521 - INFO - Running in local environment.
2025-03-29 03:02:25,521 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 03:02:25,521 - INFO - Configuration loaded:
2025-03-29 03:02:25,521 - INFO -   seq_len: 30
2025-03-29 03:02:25,521 - INFO -   batch_size: 48
2025-03-29 03:02:25,521 - INFO -   epochs: 20
2025-03-29 03:02:25,521 - INFO -   lr: 0.001
2025-03-29 03:02:25,521 - INFO -   hidden_size_lstm: 64
2025-03-29 03:02:25,521 - INFO -   hidden_size_gru: 64
2025-03-29 03:02:25,521 - INFO -   num_layers: 2
2025-03-29 03:02:25,521 - INFO -   ticker: None
2025-03-29 03:02:25,521 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 03:02:25,521 - INFO -   device: mps
2025-03-29 03:02:25,521 - INFO -   data_dir: data_files/split_data
2025-03-29 03:02:25,521 - INFO -   models_dir: models
2025-03-29 03:02:25,521 - INFO -   performance_logs_dir: performance_logs
2025-03-29 03:02:25,521 - INFO -   viz_dir: plots
2025-03-29 03:02:25,521 - INFO - Using device: mps
2025-03-29 03:02:25,522 - INFO - Checking data directory: data_files/split_data
2025-03-29 03:02:25,522 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 03:02:25,522 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 03:02:25,522 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 03:02:25,522 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 03:02:25,522 - INFO - Validated and ensured necessary directories exist.
2025-03-29 03:02:27,451 - INFO - Starting model training workflow...
2025-03-29 03:02:28,674 - INFO - Performance tracking enabled: True
2025-03-29 03:02:30,080 - INFO - Include Option Greeks features: True
2025-03-29 03:02:30,724 - INFO - Include Rolling Window features: True
2025-03-29 03:02:33,280 - INFO - Include Cyclical Date Features: False
2025-03-29 03:02:34,505 - INFO - Selected architecture: LSTM-GRU
2025-03-29 03:02:36,906 - INFO - Number of epochs set to: 20
2025-03-29 03:02:38,924 - INFO - Selected ticker for training: TU
2025-03-29 03:02:38,924 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True, Cyclical=False...
2025-03-29 03:02:38,925 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 03:02:38,925 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 03:02:38,925 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 03:02:38,925 - INFO - Include Greeks: True
2025-03-29 03:02:38,925 - INFO - Include Rolling Features: True
2025-03-29 03:02:38,925 - INFO - Include Cyclical Date Features: False
2025-03-29 03:02:38,967 - INFO - Starting rolling window feature computation...
2025-03-29 03:02:38,989 - INFO - Generated 108 rolling features.
2025-03-29 03:02:38,989 - INFO - Including 108 rolling features.
2025-03-29 03:02:38,989 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 03:02:38,989 - INFO - Including 3 original date features.
2025-03-29 03:02:38,996 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 03:02:38,997 - INFO - Dataset created for TU: Features=136, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 03:02:38,997 - INFO - Final features used (136): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month', 'day_of_week', 'day_of_year', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 03:02:38,998 - INFO - Number of features used: 136
2025-03-29 03:02:38,999 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 03:02:38,999 - INFO - Initializing LSTM-GRU (In:136, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 03:02:39,012 - INFO - Analyzing model architecture...
2025-03-29 03:02:39,012 - INFO - Analyzing architecture on device: mps:0
2025-03-29 03:02:39,136 - INFO - Model analysis complete: Total Params=137586
2025-03-29 03:02:39,137 - INFO - Starting training with performance tracking...
2025-03-29 03:02:39,137 - INFO - Initiating extended training: TU - LSTM-GRU
2025-03-29 03:02:39,137 - ERROR - Unexpected error in handle_train_model: track_performance() got an unexpected keyword argument 'device'
Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 905, in handle_train_model
    model, history, log_path = extended_train_model_with_tracking(
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/performance_utils.py", line 612, in extended_train_model_with_tracking
    log_path, history = track_performance(
TypeError: track_performance() got an unexpected keyword argument 'device'
2025-03-29 03:04:38,596 - INFO - Application terminated by user choice
2025-03-29 03:04:38,596 - INFO - Application shutdown sequence finished.
2025-03-29 03:04:47,685 - INFO - Starting Option Trading Model application
2025-03-29 03:04:47,685 - INFO - Loading configuration...
2025-03-29 03:04:47,707 - INFO - Running in local environment.
2025-03-29 03:04:47,707 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 03:04:47,707 - INFO - Configuration loaded:
2025-03-29 03:04:47,707 - INFO -   seq_len: 30
2025-03-29 03:04:47,707 - INFO -   batch_size: 48
2025-03-29 03:04:47,707 - INFO -   epochs: 20
2025-03-29 03:04:47,707 - INFO -   lr: 0.001
2025-03-29 03:04:47,707 - INFO -   hidden_size_lstm: 64
2025-03-29 03:04:47,707 - INFO -   hidden_size_gru: 64
2025-03-29 03:04:47,707 - INFO -   num_layers: 2
2025-03-29 03:04:47,707 - INFO -   ticker: None
2025-03-29 03:04:47,707 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 03:04:47,707 - INFO -   device: mps
2025-03-29 03:04:47,708 - INFO -   data_dir: data_files/split_data
2025-03-29 03:04:47,708 - INFO -   models_dir: models
2025-03-29 03:04:47,708 - INFO -   performance_logs_dir: performance_logs
2025-03-29 03:04:47,708 - INFO -   viz_dir: plots
2025-03-29 03:04:47,708 - INFO - Using device: mps
2025-03-29 03:04:47,709 - INFO - Checking data directory: data_files/split_data
2025-03-29 03:04:47,709 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 03:04:47,709 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 03:04:47,709 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 03:04:47,709 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 03:04:47,709 - INFO - Validated and ensured necessary directories exist.
2025-03-29 03:04:49,162 - INFO - Starting model training workflow...
2025-03-29 03:04:51,772 - INFO - Performance tracking enabled: True
2025-03-29 03:04:52,947 - INFO - Include Option Greeks features: True
2025-03-29 03:04:53,403 - INFO - Include Rolling Window features: True
2025-03-29 03:04:54,443 - INFO - Include Cyclical Date Features: False
2025-03-29 03:04:55,774 - INFO - Selected architecture: LSTM-GRU
2025-03-29 03:04:57,553 - INFO - Number of epochs set to: 20
2025-03-29 03:04:59,273 - INFO - Selected ticker for training: TU
2025-03-29 03:04:59,274 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True, Cyclical=False...
2025-03-29 03:04:59,275 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 03:04:59,275 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 03:04:59,275 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 03:04:59,275 - INFO - Include Greeks: True
2025-03-29 03:04:59,275 - INFO - Include Rolling Features: True
2025-03-29 03:04:59,275 - INFO - Include Cyclical Date Features: False
2025-03-29 03:04:59,315 - INFO - Starting rolling window feature computation...
2025-03-29 03:04:59,338 - INFO - Generated 108 rolling features.
2025-03-29 03:04:59,339 - INFO - Including 108 rolling features.
2025-03-29 03:04:59,339 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 03:04:59,339 - INFO - Including 3 original date features.
2025-03-29 03:04:59,345 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 03:04:59,346 - INFO - Dataset created for TU: Features=136, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 03:04:59,346 - INFO - Final features used (136): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month', 'day_of_week', 'day_of_year', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 03:04:59,347 - INFO - Number of features used: 136
2025-03-29 03:04:59,348 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 03:04:59,348 - INFO - Initializing LSTM-GRU (In:136, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 03:04:59,362 - INFO - Analyzing model architecture...
2025-03-29 03:04:59,362 - INFO - Analyzing architecture on device: mps:0
2025-03-29 03:04:59,486 - INFO - Model analysis complete: Total Params=137586
2025-03-29 03:04:59,486 - INFO - Starting training with performance tracking...
2025-03-29 03:04:59,486 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 03:04:59,486 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 03:04:59,486 - INFO - Performance log: performance_logs/LSTM-GRU_TU_20250329_030459.txt
2025-03-29 03:06:28,947 - INFO - Time series plot saved to performance_logs/plots/TU_preds_ts_LSTM-GRU_20250329_030459.png
2025-03-29 03:06:29,591 - INFO - Scatter plot saved to performance_logs/plots/TU_scatter_LSTM-GRU_20250329_030459.png
2025-03-29 03:06:29,591 - ERROR - Unexpected error in handle_train_model: name 'start_run_time' is not defined
Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 905, in handle_train_model
    model, history, log_path = extended_train_model_with_tracking(
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/performance_utils.py", line 616, in extended_train_model_with_tracking
    log_path, history = track_performance(
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/performance_utils.py", line 274, in track_performance
    end_run_time = datetime.datetime.now(); duration = end_run_time - start_run_time
NameError: name 'start_run_time' is not defined
2025-03-29 03:06:32,271 - INFO - Application terminated by user choice
2025-03-29 03:06:32,271 - INFO - Application shutdown sequence finished.
2025-03-29 03:12:35,400 - INFO - Starting Option Trading Model application
2025-03-29 03:12:35,400 - INFO - Loading configuration...
2025-03-29 03:12:35,421 - INFO - Running in local environment.
2025-03-29 03:12:35,421 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 03:12:35,421 - INFO - Configuration loaded:
2025-03-29 03:12:35,421 - INFO -   seq_len: 30
2025-03-29 03:12:35,421 - INFO -   batch_size: 48
2025-03-29 03:12:35,421 - INFO -   epochs: 20
2025-03-29 03:12:35,421 - INFO -   lr: 0.001
2025-03-29 03:12:35,421 - INFO -   hidden_size_lstm: 64
2025-03-29 03:12:35,421 - INFO -   hidden_size_gru: 64
2025-03-29 03:12:35,421 - INFO -   num_layers: 2
2025-03-29 03:12:35,421 - INFO -   ticker: None
2025-03-29 03:12:35,421 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 03:12:35,421 - INFO -   device: mps
2025-03-29 03:12:35,421 - INFO -   data_dir: data_files/split_data
2025-03-29 03:12:35,421 - INFO -   models_dir: models
2025-03-29 03:12:35,421 - INFO -   performance_logs_dir: performance_logs
2025-03-29 03:12:35,421 - INFO -   viz_dir: plots
2025-03-29 03:12:35,421 - INFO - Using device: mps
2025-03-29 03:12:35,421 - INFO - Checking data directory: data_files/split_data
2025-03-29 03:12:35,421 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 03:12:35,421 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 03:12:35,421 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 03:12:35,421 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 03:12:35,421 - INFO - Validated and ensured necessary directories exist.
2025-03-29 03:12:38,733 - INFO - Starting model training workflow...
2025-03-29 03:12:40,341 - INFO - Performance tracking enabled: True
2025-03-29 03:12:41,660 - INFO - Include Option Greeks features: True
2025-03-29 03:12:43,374 - INFO - Include Rolling Window features: False
2025-03-29 03:12:45,811 - INFO - Include Cyclical Date Features: True
2025-03-29 03:12:47,172 - INFO - Selected architecture: LSTM-GRU
2025-03-29 03:12:50,974 - INFO - Number of epochs set to: 10
2025-03-29 03:12:55,903 - INFO - Selected ticker for training: TD
2025-03-29 03:12:55,904 - INFO - Initializing dataset for TD, Greeks=True, Rolling=False, Cyclical=True...
2025-03-29 03:12:55,904 - INFO - Initializing StockOptionDataset for ticker: TD
2025-03-29 03:12:55,904 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/TD_normalized.csv
2025-03-29 03:12:55,904 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 03:12:55,904 - INFO - Include Greeks: True
2025-03-29 03:12:55,904 - INFO - Include Rolling Features: False
2025-03-29 03:12:55,904 - INFO - Include Cyclical Date Features: True
2025-03-29 03:12:56,180 - INFO - Skipping rolling window feature computation.
2025-03-29 03:12:56,181 - INFO - Excluding rolling features as requested.
2025-03-29 03:12:56,181 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 03:12:56,181 - INFO - Including 6 cyclical date features.
2025-03-29 03:12:56,195 - INFO - Dropped 6069 rows (10.84%) due to NaNs in needed columns.
2025-03-29 03:12:56,198 - INFO - Dataset created for TD: Features=31, Targets=2, Samples=49896, MaxIdx=49865
2025-03-29 03:12:56,198 - INFO - Final features used (31): ['change', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'lastPrice', 'openInterest', 'percentChange', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_15d', 'stockClose_ewm_45d', 'stockClose_ewm_5d', 'stockHigh', 'stockLow', 'stockOpen', 'stockVolume', 'strike', 'strikeDelta', 'theta', 'vega', 'volume']
2025-03-29 03:12:56,199 - INFO - Number of features used: 31
2025-03-29 03:12:56,200 - INFO - DataLoaders created: Train=39892, Val=4986, Test=4988 samples. Settings: workers=0, pin_mem=False
2025-03-29 03:12:56,200 - INFO - Initializing LSTM-GRU (In:31, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 03:12:56,213 - INFO - Analyzing model architecture...
2025-03-29 03:12:56,214 - INFO - Analyzing architecture on device: mps:0
2025-03-29 03:12:56,336 - INFO - Model analysis complete: Total Params=110496
2025-03-29 03:12:56,336 - INFO - Starting training with performance tracking...
2025-03-29 03:12:56,336 - INFO - Initiating extended training with tracking for TD - LSTM-GRU
2025-03-29 03:12:56,336 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 03:12:56,336 - INFO - Performance log: performance_logs/LSTM-GRU_TD_20250329_031256.txt
2025-03-29 03:13:12,191 - WARNING - Operation cancelled by KeyboardInterrupt.
2025-03-29 03:17:29,582 - WARNING - Operation cancelled by KeyboardInterrupt.
2025-03-29 03:17:31,947 - INFO - Application terminated by user choice
2025-03-29 03:17:31,948 - INFO - Application shutdown sequence finished.
2025-03-29 03:17:35,049 - INFO - Starting Option Trading Model application
2025-03-29 03:17:35,050 - INFO - Loading configuration...
2025-03-29 03:17:35,071 - INFO - Running in local environment.
2025-03-29 03:17:35,071 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 03:17:35,071 - INFO - Configuration loaded:
2025-03-29 03:17:35,071 - INFO -   seq_len: 30
2025-03-29 03:17:35,071 - INFO -   batch_size: 48
2025-03-29 03:17:35,071 - INFO -   epochs: 20
2025-03-29 03:17:35,071 - INFO -   lr: 0.001
2025-03-29 03:17:35,071 - INFO -   hidden_size_lstm: 64
2025-03-29 03:17:35,071 - INFO -   hidden_size_gru: 64
2025-03-29 03:17:35,071 - INFO -   num_layers: 2
2025-03-29 03:17:35,071 - INFO -   ticker: None
2025-03-29 03:17:35,071 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 03:17:35,071 - INFO -   device: mps
2025-03-29 03:17:35,071 - INFO -   data_dir: data_files/split_data
2025-03-29 03:17:35,071 - INFO -   models_dir: models
2025-03-29 03:17:35,071 - INFO -   performance_logs_dir: performance_logs
2025-03-29 03:17:35,071 - INFO -   viz_dir: plots
2025-03-29 03:17:35,071 - INFO - Using device: mps
2025-03-29 03:17:35,071 - INFO - Checking data directory: data_files/split_data
2025-03-29 03:17:35,071 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 03:17:35,071 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 03:17:35,071 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 03:17:35,071 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 03:17:35,071 - INFO - Validated and ensured necessary directories exist.
2025-03-29 03:17:36,359 - INFO - Starting model training workflow...
2025-03-29 03:17:38,960 - INFO - Performance tracking enabled: True
2025-03-29 03:17:40,182 - INFO - Include Option Greeks features: True
2025-03-29 03:17:41,300 - INFO - Include Rolling Window features: True
2025-03-29 03:17:45,090 - INFO - Include Cyclical Date Features: True
2025-03-29 03:17:46,380 - INFO - Selected architecture: LSTM-GRU
2025-03-29 03:17:47,787 - INFO - Number of epochs set to: 10
2025-03-29 03:17:52,169 - INFO - Selected ticker for training: RDSB
2025-03-29 03:17:52,169 - INFO - Initializing dataset for RDSB, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 03:17:52,169 - INFO - Initializing StockOptionDataset for ticker: RDSB
2025-03-29 03:17:52,169 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/RDSB_normalized.csv
2025-03-29 03:17:52,169 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 03:17:52,170 - INFO - Include Greeks: True
2025-03-29 03:17:52,170 - INFO - Include Rolling Features: True
2025-03-29 03:17:52,170 - INFO - Include Cyclical Date Features: True
2025-03-29 03:17:52,194 - INFO - Starting rolling window feature computation...
2025-03-29 03:17:52,212 - INFO - Generated 108 rolling features.
2025-03-29 03:17:52,212 - INFO - Including 108 rolling features.
2025-03-29 03:17:52,212 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 03:17:52,212 - INFO - Including 6 cyclical date features.
2025-03-29 03:17:52,216 - INFO - Dropped 333 rows (7.86%) due to NaNs in needed columns.
2025-03-29 03:17:52,217 - INFO - Dataset created for RDSB: Features=139, Targets=2, Samples=3904, MaxIdx=3873
2025-03-29 03:17:52,218 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 03:17:52,219 - INFO - Number of features used: 139
2025-03-29 03:17:52,219 - INFO - DataLoaders created: Train=3099, Val=387, Test=388 samples. Settings: workers=0, pin_mem=False
2025-03-29 03:17:52,219 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 03:17:52,232 - INFO - Analyzing model architecture...
2025-03-29 03:17:52,232 - INFO - Analyzing architecture on device: mps:0
2025-03-29 03:17:52,357 - INFO - Model analysis complete: Total Params=138360
2025-03-29 03:17:52,357 - INFO - Starting training with performance tracking...
2025-03-29 03:17:52,357 - INFO - Initiating extended training with tracking for RDSB - LSTM-GRU
2025-03-29 03:17:52,357 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 03:17:52,357 - INFO - Performance log: performance_logs/LSTM-GRU_RDSB_20250329_031752.txt
2025-03-29 03:18:57,850 - INFO - Time series plot saved to performance_logs/plots/RDSB_timeseries_LSTM-GRU_20250329_031752.png
2025-03-29 03:18:58,570 - INFO - Density heatmap saved to performance_logs/plots/RDSB_density_heatmap_LSTM-GRU_20250329_031752.png
2025-03-29 03:18:58,570 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_RDSB_20250329_031752.txt
2025-03-29 03:18:58,571 - INFO - Extended training complete. Log: performance_logs/LSTM-GRU_RDSB_20250329_031752.txt
2025-03-29 03:18:58,571 - INFO - Saving model and results...
2025-03-29 03:18:58,582 - INFO - Model saved to models/HybridRNN_RDSB_target_bid-ask_20250329_031858.pth
2025-03-29 03:18:58,954 - INFO - Training plot saved to plots/training_plot_RDSB_bid-ask_20250329_031858.png
2025-03-29 03:18:59,729 - INFO - Time series plot saved to plots/RDSB_timeseries_test_set_20250329_031858.png
2025-03-29 03:19:00,405 - INFO - Density heatmap saved to plots/RDSB_density_heatmap_test_set_20250329_031858.png
2025-03-29 03:19:00,405 - INFO - Model training workflow completed successfully.
2025-03-29 03:19:28,312 - INFO - Starting model training workflow...
2025-03-29 03:19:29,919 - INFO - Performance tracking enabled: True
2025-03-29 03:19:30,234 - INFO - Include Option Greeks features: True
2025-03-29 03:19:30,560 - INFO - Include Rolling Window features: True
2025-03-29 03:19:31,192 - INFO - Include Cyclical Date Features: True
2025-03-29 03:19:32,089 - INFO - Selected architecture: LSTM-GRU
2025-03-29 03:19:32,795 - INFO - Number of epochs set to: 20
2025-03-29 03:19:34,857 - INFO - Selected ticker for training: TU
2025-03-29 03:19:34,857 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 03:19:34,857 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 03:19:34,857 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 03:19:34,858 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 03:19:34,858 - INFO - Include Greeks: True
2025-03-29 03:19:34,858 - INFO - Include Rolling Features: True
2025-03-29 03:19:34,858 - INFO - Include Cyclical Date Features: True
2025-03-29 03:19:34,889 - INFO - Starting rolling window feature computation...
2025-03-29 03:19:34,909 - INFO - Generated 108 rolling features.
2025-03-29 03:19:34,910 - INFO - Including 108 rolling features.
2025-03-29 03:19:34,910 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 03:19:34,910 - INFO - Including 6 cyclical date features.
2025-03-29 03:19:34,915 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 03:19:34,917 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 03:19:34,917 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 03:19:34,918 - INFO - Number of features used: 139
2025-03-29 03:19:34,918 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 03:19:34,918 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 03:19:34,929 - INFO - Analyzing model architecture...
2025-03-29 03:19:34,929 - INFO - Analyzing architecture on device: mps:0
2025-03-29 03:19:34,958 - INFO - Model analysis complete: Total Params=138360
2025-03-29 03:19:34,958 - INFO - Starting training with performance tracking...
2025-03-29 03:19:34,958 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 03:19:34,958 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 03:19:34,958 - INFO - Performance log: performance_logs/LSTM-GRU_TU_20250329_031934.txt
2025-03-29 03:21:20,964 - INFO - Time series plot saved to performance_logs/plots/TU_timeseries_LSTM-GRU_20250329_031934.png
2025-03-29 03:21:21,674 - INFO - Density heatmap saved to performance_logs/plots/TU_density_heatmap_LSTM-GRU_20250329_031934.png
2025-03-29 03:21:21,674 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_TU_20250329_031934.txt
2025-03-29 03:21:21,675 - INFO - Extended training complete. Log: performance_logs/LSTM-GRU_TU_20250329_031934.txt
2025-03-29 03:21:21,675 - INFO - Saving model and results...
2025-03-29 03:21:21,687 - INFO - Model saved to models/HybridRNN_TU_target_bid-ask_20250329_032121.pth
2025-03-29 03:21:22,063 - INFO - Training plot saved to plots/training_plot_TU_bid-ask_20250329_032121.png
2025-03-29 03:21:22,824 - INFO - Time series plot saved to plots/TU_timeseries_test_set_20250329_032121.png
2025-03-29 03:21:23,526 - INFO - Density heatmap saved to plots/TU_density_heatmap_test_set_20250329_032121.png
2025-03-29 03:21:23,526 - INFO - Model training workflow completed successfully.
2025-03-29 03:28:38,037 - INFO - Application terminated by user choice
2025-03-29 03:28:38,038 - INFO - Application shutdown sequence finished.
2025-03-29 03:28:41,190 - INFO - Starting Option Trading Model application
2025-03-29 03:28:41,190 - INFO - Loading configuration...
2025-03-29 03:28:41,211 - INFO - Running in local environment.
2025-03-29 03:28:41,211 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 03:28:41,211 - INFO - Configuration loaded:
2025-03-29 03:28:41,211 - INFO -   seq_len: 30
2025-03-29 03:28:41,211 - INFO -   batch_size: 48
2025-03-29 03:28:41,211 - INFO -   epochs: 20
2025-03-29 03:28:41,211 - INFO -   lr: 0.001
2025-03-29 03:28:41,211 - INFO -   hidden_size_lstm: 64
2025-03-29 03:28:41,211 - INFO -   hidden_size_gru: 64
2025-03-29 03:28:41,211 - INFO -   num_layers: 2
2025-03-29 03:28:41,211 - INFO -   ticker: None
2025-03-29 03:28:41,211 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 03:28:41,211 - INFO -   device: mps
2025-03-29 03:28:41,211 - INFO -   data_dir: data_files/split_data
2025-03-29 03:28:41,211 - INFO -   models_dir: models
2025-03-29 03:28:41,211 - INFO -   performance_logs_dir: performance_logs
2025-03-29 03:28:41,211 - INFO -   viz_dir: plots
2025-03-29 03:28:41,212 - INFO - Using device: mps
2025-03-29 03:28:41,212 - INFO - Checking data directory: data_files/split_data
2025-03-29 03:28:41,212 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 03:28:41,212 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 03:28:41,212 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 03:28:41,212 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 03:28:41,212 - INFO - Validated and ensured necessary directories exist.
2025-03-29 03:28:47,149 - INFO - Starting model training workflow...
2025-03-29 03:28:48,229 - INFO - Performance tracking enabled: True
2025-03-29 03:28:48,845 - INFO - Include Option Greeks features: True
2025-03-29 03:28:49,442 - INFO - Include Rolling Window features: True
2025-03-29 03:28:50,420 - INFO - Include Cyclical Date Features: True
2025-03-29 03:28:51,733 - INFO - Selected architecture: LSTM-GRU
2025-03-29 03:28:53,178 - INFO - Number of epochs set to: 10
2025-03-29 03:28:55,174 - INFO - Selected ticker for training: TU
2025-03-29 03:28:55,175 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 03:28:55,175 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 03:28:55,175 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 03:28:55,175 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 03:28:55,175 - INFO - Include Greeks: True
2025-03-29 03:28:55,175 - INFO - Include Rolling Features: True
2025-03-29 03:28:55,175 - INFO - Include Cyclical Date Features: True
2025-03-29 03:28:55,228 - INFO - Starting rolling window feature computation...
2025-03-29 03:28:55,250 - INFO - Generated 108 rolling features.
2025-03-29 03:28:55,250 - INFO - Including 108 rolling features.
2025-03-29 03:28:55,251 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 03:28:55,251 - INFO - Including 6 cyclical date features.
2025-03-29 03:28:55,257 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 03:28:55,258 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 03:28:55,258 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 03:28:55,259 - INFO - Number of features used: 139
2025-03-29 03:28:55,259 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 03:28:55,259 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 03:28:55,273 - INFO - Analyzing model architecture...
2025-03-29 03:28:55,273 - INFO - Analyzing architecture on device: mps:0
2025-03-29 03:28:55,392 - INFO - Model analysis complete: Total Params=138360
2025-03-29 03:28:55,392 - INFO - Starting training with performance tracking...
2025-03-29 03:28:55,393 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 03:28:55,393 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 03:28:55,393 - INFO - Performance log: performance_logs/LSTM-GRU_TU_20250329_032855.txt
2025-03-29 03:30:24,791 - INFO - Time series plot saved to performance_logs/plots/TU_timeseries_LSTM-GRU_20250329_032855.png
2025-03-29 03:30:25,531 - INFO - Density heatmap saved to performance_logs/plots/TU_density_heatmap_LSTM-GRU_20250329_032855.png
2025-03-29 03:30:25,532 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_TU_20250329_032855.txt
2025-03-29 03:30:25,532 - INFO - Extended training complete. Log: performance_logs/LSTM-GRU_TU_20250329_032855.txt
2025-03-29 03:30:25,532 - INFO - Saving model and results...
2025-03-29 03:30:25,543 - INFO - Model saved to models/HybridRNN_TU_target_bid-ask_20250329_033025.pth
2025-03-29 03:30:25,904 - INFO - Training plot saved to plots/training_plot_TU_bid-ask_20250329_033025.png
2025-03-29 03:30:26,664 - INFO - Time series plot saved to plots/TU_timeseries_test_set_20250329_033025.png
2025-03-29 03:30:27,340 - INFO - Density heatmap saved to plots/TU_density_heatmap_test_set_20250329_033025.png
2025-03-29 03:30:27,340 - INFO - Model training workflow completed successfully.
2025-03-29 03:38:58,764 - INFO - Application terminated by user choice
2025-03-29 03:38:58,764 - INFO - Application shutdown sequence finished.
2025-03-29 03:39:02,665 - INFO - Starting Option Trading Model application
2025-03-29 03:39:02,666 - INFO - Loading configuration...
2025-03-29 03:39:02,686 - INFO - Running in local environment.
2025-03-29 03:39:02,686 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 03:39:02,686 - INFO - Configuration loaded:
2025-03-29 03:39:02,686 - INFO -   seq_len: 30
2025-03-29 03:39:02,686 - INFO -   batch_size: 48
2025-03-29 03:39:02,686 - INFO -   epochs: 20
2025-03-29 03:39:02,686 - INFO -   lr: 0.001
2025-03-29 03:39:02,686 - INFO -   hidden_size_lstm: 64
2025-03-29 03:39:02,686 - INFO -   hidden_size_gru: 64
2025-03-29 03:39:02,686 - INFO -   num_layers: 2
2025-03-29 03:39:02,686 - INFO -   ticker: None
2025-03-29 03:39:02,686 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 03:39:02,686 - INFO -   device: mps
2025-03-29 03:39:02,686 - INFO -   data_dir: data_files/split_data
2025-03-29 03:39:02,686 - INFO -   models_dir: models
2025-03-29 03:39:02,686 - INFO -   performance_logs_dir: performance_logs
2025-03-29 03:39:02,686 - INFO -   viz_dir: plots
2025-03-29 03:39:02,686 - INFO - Using device: mps
2025-03-29 03:39:02,686 - INFO - Checking data directory: data_files/split_data
2025-03-29 03:39:02,686 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 03:39:02,686 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 03:39:02,686 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 03:39:02,687 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 03:39:02,687 - INFO - Validated and ensured necessary directories exist.
2025-03-29 03:39:04,240 - INFO - Starting model training workflow...
2025-03-29 03:39:05,989 - INFO - Performance tracking enabled: True
2025-03-29 03:39:06,813 - INFO - Include Option Greeks features: True
2025-03-29 03:39:08,259 - INFO - Include Rolling Window features: False
2025-03-29 03:39:10,426 - INFO - Include Cyclical Date Features: True
2025-03-29 03:39:11,956 - INFO - Selected architecture: LSTM-GRU
2025-03-29 03:39:14,615 - INFO - Number of epochs set to: 10
2025-03-29 03:39:30,671 - INFO - Selected ticker for training: HSBC
2025-03-29 03:39:30,671 - INFO - Initializing dataset for HSBC, Greeks=True, Rolling=False, Cyclical=True...
2025-03-29 03:39:30,671 - INFO - Initializing StockOptionDataset for ticker: HSBC
2025-03-29 03:39:30,671 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/HSBC_normalized.csv
2025-03-29 03:39:30,671 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 03:39:30,671 - INFO - Include Greeks: True
2025-03-29 03:39:30,671 - INFO - Include Rolling Features: False
2025-03-29 03:39:30,671 - INFO - Include Cyclical Date Features: True
2025-03-29 03:39:30,936 - INFO - Skipping rolling window feature computation.
2025-03-29 03:39:30,936 - INFO - Excluding rolling features as requested.
2025-03-29 03:39:30,936 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 03:39:30,936 - INFO - Including 6 cyclical date features.
2025-03-29 03:39:30,950 - INFO - Dropped 7864 rows (13.42%) due to NaNs in needed columns.
2025-03-29 03:39:30,952 - INFO - Dataset created for HSBC: Features=31, Targets=2, Samples=50738, MaxIdx=50707
2025-03-29 03:39:30,952 - INFO - Final features used (31): ['change', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'lastPrice', 'openInterest', 'percentChange', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_15d', 'stockClose_ewm_45d', 'stockClose_ewm_5d', 'stockHigh', 'stockLow', 'stockOpen', 'stockVolume', 'strike', 'strikeDelta', 'theta', 'vega', 'volume']
2025-03-29 03:39:30,953 - INFO - Number of features used: 31
2025-03-29 03:39:30,954 - INFO - DataLoaders created: Train=40566, Val=5070, Test=5072 samples. Settings: workers=0, pin_mem=False
2025-03-29 03:39:30,954 - INFO - Initializing LSTM-GRU (In:31, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 03:39:30,966 - INFO - Analyzing model architecture...
2025-03-29 03:39:30,966 - INFO - Analyzing architecture on device: mps:0
2025-03-29 03:39:31,088 - INFO - Model analysis complete: Total Params=110496
2025-03-29 03:39:31,088 - INFO - Starting training with performance tracking...
2025-03-29 03:39:31,088 - INFO - Initiating extended training with tracking for HSBC - LSTM-GRU
2025-03-29 03:39:31,088 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 03:39:31,088 - INFO - Performance log: performance_logs/LSTM-GRU_HSBC_20250329_033931.txt
2025-03-29 03:53:08,784 - INFO - Plotting ticker HSBC with 5072 data points
2025-03-29 03:53:10,037 - INFO - Time series plot saved to performance_logs/plots/HSBC_timeseries_LSTM-GRU_20250329_033931.png
2025-03-29 03:53:10,049 - ERROR - Failed to generate prediction analysis plot: module 'matplotlib.pyplot' has no attribute 'SubFigure'
2025-03-29 03:53:10,049 - ERROR - Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/visualization_utils.py", line 356, in plot_predictions
    if isinstance(top_axes[i], plt.SubFigure):
AttributeError: module 'matplotlib.pyplot' has no attribute 'SubFigure'

2025-03-29 03:53:10,050 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_HSBC_20250329_033931.txt
2025-03-29 03:53:10,051 - INFO - Extended training complete. Log: performance_logs/LSTM-GRU_HSBC_20250329_033931.txt
2025-03-29 03:53:10,051 - INFO - Saving model and results...
2025-03-29 03:53:10,061 - INFO - Model saved to models/HybridRNN_HSBC_target_bid-ask_20250329_035310.pth
2025-03-29 03:53:10,521 - INFO - Training plot saved to plots/training_plot_HSBC_bid-ask_20250329_035310.png
2025-03-29 03:53:10,524 - INFO - Plotting ticker HSBC with 5072 data points
2025-03-29 03:53:11,660 - INFO - Time series plot saved to plots/HSBC_timeseries_test_set_20250329_035310.png
2025-03-29 03:53:11,670 - ERROR - Failed to generate prediction analysis plot: module 'matplotlib.pyplot' has no attribute 'SubFigure'
2025-03-29 03:53:11,670 - ERROR - Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/visualization_utils.py", line 356, in plot_predictions
    if isinstance(top_axes[i], plt.SubFigure):
AttributeError: module 'matplotlib.pyplot' has no attribute 'SubFigure'

2025-03-29 03:53:11,671 - INFO - Model training workflow completed successfully.
2025-03-29 03:55:42,404 - INFO - Application terminated by user choice
2025-03-29 03:55:42,405 - INFO - Application shutdown sequence finished.
2025-03-29 03:55:46,633 - INFO - Starting Option Trading Model application
2025-03-29 03:55:46,633 - INFO - Loading configuration...
2025-03-29 03:55:46,655 - INFO - Running in local environment.
2025-03-29 03:55:46,655 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 03:55:46,656 - INFO - Configuration loaded:
2025-03-29 03:55:46,656 - INFO -   seq_len: 30
2025-03-29 03:55:46,656 - INFO -   batch_size: 48
2025-03-29 03:55:46,656 - INFO -   epochs: 20
2025-03-29 03:55:46,656 - INFO -   lr: 0.001
2025-03-29 03:55:46,656 - INFO -   hidden_size_lstm: 64
2025-03-29 03:55:46,656 - INFO -   hidden_size_gru: 64
2025-03-29 03:55:46,656 - INFO -   num_layers: 2
2025-03-29 03:55:46,656 - INFO -   ticker: None
2025-03-29 03:55:46,656 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 03:55:46,656 - INFO -   device: mps
2025-03-29 03:55:46,656 - INFO -   data_dir: data_files/split_data
2025-03-29 03:55:46,656 - INFO -   models_dir: models
2025-03-29 03:55:46,656 - INFO -   performance_logs_dir: performance_logs
2025-03-29 03:55:46,656 - INFO -   viz_dir: plots
2025-03-29 03:55:46,656 - INFO - Using device: mps
2025-03-29 03:55:46,656 - INFO - Checking data directory: data_files/split_data
2025-03-29 03:55:46,656 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 03:55:46,656 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 03:55:46,656 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 03:55:46,656 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 03:55:46,656 - INFO - Validated and ensured necessary directories exist.
2025-03-29 03:55:48,197 - INFO - Starting model training workflow...
2025-03-29 03:55:49,684 - INFO - Performance tracking enabled: True
2025-03-29 03:55:51,551 - INFO - Include Option Greeks features: True
2025-03-29 03:55:53,236 - INFO - Include Rolling Window features: False
2025-03-29 03:55:54,663 - INFO - Include Cyclical Date Features: True
2025-03-29 03:55:56,105 - INFO - Selected architecture: LSTM-GRU
2025-03-29 03:55:59,135 - INFO - Number of epochs set to: 6
2025-03-29 03:56:06,194 - INFO - Selected ticker for training: TU
2025-03-29 03:56:06,195 - INFO - Initializing dataset for TU, Greeks=True, Rolling=False, Cyclical=True...
2025-03-29 03:56:06,195 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 03:56:06,195 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 03:56:06,195 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 03:56:06,195 - INFO - Include Greeks: True
2025-03-29 03:56:06,195 - INFO - Include Rolling Features: False
2025-03-29 03:56:06,195 - INFO - Include Cyclical Date Features: True
2025-03-29 03:56:06,239 - INFO - Skipping rolling window feature computation.
2025-03-29 03:56:06,239 - INFO - Excluding rolling features as requested.
2025-03-29 03:56:06,239 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 03:56:06,239 - INFO - Including 6 cyclical date features.
2025-03-29 03:56:06,242 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 03:56:06,242 - INFO - Dataset created for TU: Features=31, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 03:56:06,242 - INFO - Final features used (31): ['change', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'lastPrice', 'openInterest', 'percentChange', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_15d', 'stockClose_ewm_45d', 'stockClose_ewm_5d', 'stockHigh', 'stockLow', 'stockOpen', 'stockVolume', 'strike', 'strikeDelta', 'theta', 'vega', 'volume']
2025-03-29 03:56:06,242 - INFO - Number of features used: 31
2025-03-29 03:56:06,243 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 03:56:06,243 - INFO - Initializing LSTM-GRU (In:31, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 03:56:06,257 - INFO - Analyzing model architecture...
2025-03-29 03:56:06,257 - INFO - Analyzing architecture on device: mps:0
2025-03-29 03:56:06,383 - INFO - Model analysis complete: Total Params=110496
2025-03-29 03:56:06,383 - INFO - Starting training with performance tracking...
2025-03-29 03:56:06,383 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 03:56:06,383 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 03:56:06,383 - INFO - Performance log: performance_logs/LSTM-GRU_TU_20250329_035606.txt
2025-03-29 03:56:58,600 - INFO - Plotting ticker TU with 547 data points
2025-03-29 03:56:59,300 - INFO - Time series plot saved to performance_logs/plots/TU_timeseries_LSTM-GRU_20250329_035606.png
2025-03-29 03:57:00,137 - INFO - Prediction analysis plot for bid saved to performance_logs/plots/TU_bid_prediction_analysis_LSTM-GRU_20250329_035606.png
2025-03-29 03:57:00,897 - INFO - Prediction analysis plot for ask saved to performance_logs/plots/TU_ask_prediction_analysis_LSTM-GRU_20250329_035606.png
2025-03-29 03:57:01,388 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_TU_20250329_035606.txt
2025-03-29 03:57:01,389 - INFO - Extended training complete. Log: performance_logs/LSTM-GRU_TU_20250329_035606.txt
2025-03-29 03:57:01,389 - INFO - Saving model and results...
2025-03-29 03:57:01,401 - INFO - Model saved to models/HybridRNN_TU_target_bid-ask_20250329_035701.pth
2025-03-29 03:57:01,772 - INFO - Training plot saved to plots/training_plot_TU_bid-ask_20250329_035701.png
2025-03-29 03:57:01,773 - INFO - Plotting ticker TU with 547 data points
2025-03-29 03:57:02,354 - INFO - Time series plot saved to plots/TU_timeseries_test_set_20250329_035701.png
2025-03-29 03:57:03,112 - INFO - Prediction analysis plot for bid saved to plots/TU_bid_prediction_analysis_test_set_20250329_035701.png
2025-03-29 03:57:03,887 - INFO - Prediction analysis plot for ask saved to plots/TU_ask_prediction_analysis_test_set_20250329_035701.png
2025-03-29 03:57:04,382 - INFO - Model training workflow completed successfully.
2025-03-29 04:04:38,648 - INFO - Starting model prediction workflow...
2025-03-29 04:04:43,067 - INFO - Selected model file: HybridRNN_RDSB_target_bid-ask_20250329_031858.pth
2025-03-29 04:04:43,067 - INFO - Determining model class from name: HybridRNN_RDSB_target_bid-ask_20250329_031858.pth
2025-03-29 04:04:43,067 - INFO - Selected LSTM-GRU hybrid model architecture (default)
2025-03-29 04:04:47,714 - INFO - Selected ticker for prediction: TU
2025-03-29 04:04:47,714 - INFO - Creating dataset for TU with Greeks=True, Rolling=True
2025-03-29 04:04:51,308 - INFO - Running predictions for TU using HybridRNN_RDSB_target_bid-ask_20250329_031858.pth
2025-03-29 04:04:51,308 - INFO - Running standard prediction (no visualization)...
2025-03-29 04:04:51,308 - ERROR - Error during standard prediction run: load_model() got an unexpected keyword argument 'device'
2025-03-29 04:04:51,308 - INFO - Prediction workflow for TU completed successfully.
2025-03-29 04:06:56,960 - INFO - Application terminated by user choice
2025-03-29 04:06:56,960 - INFO - Application shutdown sequence finished.
2025-03-29 04:07:04,496 - INFO - Starting Option Trading Model application
2025-03-29 04:07:04,496 - INFO - Loading configuration...
2025-03-29 04:07:04,518 - INFO - Running in local environment.
2025-03-29 04:07:04,518 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 04:07:04,518 - INFO - Configuration loaded:
2025-03-29 04:07:04,518 - INFO -   seq_len: 30
2025-03-29 04:07:04,518 - INFO -   batch_size: 48
2025-03-29 04:07:04,518 - INFO -   epochs: 20
2025-03-29 04:07:04,518 - INFO -   lr: 0.001
2025-03-29 04:07:04,518 - INFO -   hidden_size_lstm: 64
2025-03-29 04:07:04,518 - INFO -   hidden_size_gru: 64
2025-03-29 04:07:04,518 - INFO -   num_layers: 2
2025-03-29 04:07:04,518 - INFO -   ticker: None
2025-03-29 04:07:04,518 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 04:07:04,518 - INFO -   device: mps
2025-03-29 04:07:04,518 - INFO -   data_dir: data_files/split_data
2025-03-29 04:07:04,518 - INFO -   models_dir: models
2025-03-29 04:07:04,519 - INFO -   performance_logs_dir: performance_logs
2025-03-29 04:07:04,519 - INFO -   viz_dir: plots
2025-03-29 04:07:04,519 - INFO - Using device: mps
2025-03-29 04:07:04,519 - INFO - Checking data directory: data_files/split_data
2025-03-29 04:07:04,519 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 04:07:04,519 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 04:07:04,519 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 04:07:04,519 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 04:07:04,519 - INFO - Validated and ensured necessary directories exist.
2025-03-29 04:07:07,054 - INFO - Starting model prediction workflow...
2025-03-29 04:07:10,227 - INFO - Selected model file: HybridRNN_RDSB_target_bid-ask_20250329_031858.pth
2025-03-29 04:07:10,227 - INFO - Determining model class from name: HybridRNN_RDSB_target_bid-ask_20250329_031858.pth
2025-03-29 04:07:10,227 - INFO - Selected LSTM-GRU hybrid model architecture (default)
2025-03-29 04:07:12,287 - INFO - Selected ticker for prediction: SU
2025-03-29 04:07:12,287 - INFO - Creating dataset for SU with Greeks=True, Rolling=True
2025-03-29 04:07:15,462 - INFO - Running predictions for SU using HybridRNN_RDSB_target_bid-ask_20250329_031858.pth
2025-03-29 04:07:15,462 - INFO - Running standard prediction (no visualization)...
2025-03-29 04:07:15,462 - INFO - Loading model from: models/HybridRNN_RDSB_target_bid-ask_20250329_031858.pth
2025-03-29 04:07:15,462 - INFO - Target device: mps
2025-03-29 04:07:15,462 - INFO - Using Model class: HybridRNNModel
2025-03-29 04:07:15,462 - INFO - Input size: 139, Output size: 2
2025-03-29 04:07:15,462 - INFO - Creating HybridRNNModel with hidden sizes: LSTM=64, GRU=64
2025-03-29 04:07:15,466 - INFO - Loading model state_dict to device: mps
2025-03-29 04:07:15,500 - INFO - Model loaded and set to evaluation mode successfully on device: mps
2025-03-29 04:08:02,639 - INFO - Prediction workflow for SU completed successfully.
2025-03-29 04:08:20,895 - INFO - Starting model training workflow...
2025-03-29 04:08:22,578 - INFO - Performance tracking enabled: True
2025-03-29 04:08:22,889 - INFO - Include Option Greeks features: True
2025-03-29 04:08:23,207 - INFO - Include Rolling Window features: True
2025-03-29 04:08:24,006 - INFO - Include Cyclical Date Features: True
2025-03-29 04:08:25,939 - INFO - Selected architecture: LSTM-GRU
2025-03-29 04:08:30,552 - INFO - Number of epochs set to: 8
2025-03-29 04:08:33,434 - INFO - Selected ticker for training: TU
2025-03-29 04:08:33,435 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 04:08:33,435 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 04:08:33,435 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 04:08:33,435 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 04:08:33,435 - INFO - Include Greeks: True
2025-03-29 04:08:33,435 - INFO - Include Rolling Features: True
2025-03-29 04:08:33,435 - INFO - Include Cyclical Date Features: True
2025-03-29 04:08:33,468 - INFO - Starting rolling window feature computation...
2025-03-29 04:08:33,491 - INFO - Generated 108 rolling features.
2025-03-29 04:08:33,491 - INFO - Including 108 rolling features.
2025-03-29 04:08:33,491 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 04:08:33,491 - INFO - Including 6 cyclical date features.
2025-03-29 04:08:33,501 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 04:08:33,502 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 04:08:33,503 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 04:08:33,503 - INFO - Number of features used: 139
2025-03-29 04:08:33,504 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 04:08:33,504 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 04:08:33,515 - INFO - Analyzing model architecture...
2025-03-29 04:08:33,515 - INFO - Analyzing architecture on device: mps:0
2025-03-29 04:08:33,589 - INFO - Model analysis complete: Total Params=138360
2025-03-29 04:08:33,589 - INFO - Starting training with performance tracking...
2025-03-29 04:08:33,589 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 04:08:33,589 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 04:08:33,589 - INFO - Performance log: performance_logs/LSTM-GRU_TU_20250329_040833.txt
2025-03-29 04:09:35,900 - INFO - Plotting ticker TU with 547 data points
2025-03-29 04:09:36,746 - INFO - Time series plot saved to performance_logs/plots/TU_timeseries_LSTM-GRU_20250329_040833.png
2025-03-29 04:09:37,213 - INFO - 2D histogram for bid saved to performance_logs/plots/TU_bid_2dhist_LSTM-GRU_20250329_040833.png
2025-03-29 04:09:37,537 - INFO - 2D histogram for ask saved to performance_logs/plots/TU_ask_2dhist_LSTM-GRU_20250329_040833.png
2025-03-29 04:09:37,899 - INFO - Error distribution plot for bid saved to performance_logs/plots/TU_bid_error_dist_LSTM-GRU_20250329_040833.png
2025-03-29 04:09:38,266 - INFO - Error distribution plot for ask saved to performance_logs/plots/TU_ask_error_dist_LSTM-GRU_20250329_040833.png
2025-03-29 04:09:38,267 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_TU_20250329_040833.txt
2025-03-29 04:09:38,267 - INFO - Extended training complete. Log: performance_logs/LSTM-GRU_TU_20250329_040833.txt
2025-03-29 04:09:38,267 - INFO - Saving model and results...
2025-03-29 04:09:38,278 - INFO - Model saved to models/HybridRNN_TU_target_bid-ask_20250329_040938.pth
2025-03-29 04:09:38,652 - INFO - Training plot saved to plots/training_plot_TU_bid-ask_20250329_040938.png
2025-03-29 04:09:38,652 - INFO - Plotting ticker TU with 547 data points
2025-03-29 04:09:39,376 - INFO - Time series plot saved to plots/TU_timeseries_test_set_20250329_040938.png
2025-03-29 04:09:39,704 - INFO - 2D histogram for bid saved to plots/TU_bid_2dhist_test_set_20250329_040938.png
2025-03-29 04:09:40,027 - INFO - 2D histogram for ask saved to plots/TU_ask_2dhist_test_set_20250329_040938.png
2025-03-29 04:09:40,383 - INFO - Error distribution plot for bid saved to plots/TU_bid_error_dist_test_set_20250329_040938.png
2025-03-29 04:09:40,752 - INFO - Error distribution plot for ask saved to plots/TU_ask_error_dist_test_set_20250329_040938.png
2025-03-29 04:09:40,753 - INFO - Model training workflow completed successfully.
2025-03-29 04:17:24,073 - INFO - Application terminated by user choice
2025-03-29 04:17:24,073 - INFO - Application shutdown sequence finished.
2025-03-29 04:17:29,396 - INFO - Starting Option Trading Model application
2025-03-29 04:17:29,396 - INFO - Loading configuration...
2025-03-29 04:17:29,417 - INFO - Running in local environment.
2025-03-29 04:17:29,417 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 04:17:29,417 - INFO - Configuration loaded:
2025-03-29 04:17:29,417 - INFO -   seq_len: 30
2025-03-29 04:17:29,417 - INFO -   batch_size: 48
2025-03-29 04:17:29,417 - INFO -   epochs: 20
2025-03-29 04:17:29,417 - INFO -   lr: 0.001
2025-03-29 04:17:29,417 - INFO -   hidden_size_lstm: 64
2025-03-29 04:17:29,417 - INFO -   hidden_size_gru: 64
2025-03-29 04:17:29,417 - INFO -   num_layers: 2
2025-03-29 04:17:29,418 - INFO -   ticker: None
2025-03-29 04:17:29,418 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 04:17:29,418 - INFO -   device: mps
2025-03-29 04:17:29,418 - INFO -   data_dir: data_files/split_data
2025-03-29 04:17:29,418 - INFO -   models_dir: models
2025-03-29 04:17:29,418 - INFO -   performance_logs_dir: performance_logs
2025-03-29 04:17:29,418 - INFO -   viz_dir: plots
2025-03-29 04:17:29,418 - INFO - Using device: mps
2025-03-29 04:17:29,418 - INFO - Checking data directory: data_files/split_data
2025-03-29 04:17:29,418 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 04:17:29,418 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 04:17:29,418 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 04:17:29,418 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 04:17:29,418 - INFO - Validated and ensured necessary directories exist.
2025-03-29 04:17:31,322 - INFO - Starting model training workflow...
2025-03-29 04:17:32,575 - INFO - Performance tracking enabled: True
2025-03-29 04:17:33,225 - INFO - Include Option Greeks features: True
2025-03-29 04:17:33,948 - INFO - Include Rolling Window features: True
2025-03-29 04:17:34,632 - INFO - Include Cyclical Date Features: True
2025-03-29 04:17:35,840 - INFO - Selected architecture: LSTM-GRU
2025-03-29 04:17:38,113 - INFO - Number of epochs set to: 7
2025-03-29 04:17:42,083 - INFO - Selected ticker for training: TU
2025-03-29 04:17:42,084 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 04:17:42,084 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 04:17:42,084 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 04:17:42,084 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 04:17:42,084 - INFO - Include Greeks: True
2025-03-29 04:17:42,084 - INFO - Include Rolling Features: True
2025-03-29 04:17:42,084 - INFO - Include Cyclical Date Features: True
2025-03-29 04:17:42,136 - INFO - Starting rolling window feature computation...
2025-03-29 04:17:42,159 - INFO - Generated 108 rolling features.
2025-03-29 04:17:42,160 - INFO - Including 108 rolling features.
2025-03-29 04:17:42,160 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 04:17:42,160 - INFO - Including 6 cyclical date features.
2025-03-29 04:17:42,166 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 04:17:42,168 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 04:17:42,168 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 04:17:42,169 - INFO - Number of features used: 139
2025-03-29 04:17:42,169 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 04:17:42,169 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 04:17:42,184 - INFO - Analyzing model architecture...
2025-03-29 04:17:42,184 - INFO - Analyzing architecture on device: mps:0
2025-03-29 04:17:42,305 - INFO - Model analysis complete: Total Params=138360
2025-03-29 04:17:42,305 - INFO - Starting training with performance tracking...
2025-03-29 04:17:42,305 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 04:17:42,305 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 04:17:42,305 - INFO - Performance log: performance_logs/LSTM-GRU_TU_20250329_041742.txt
2025-03-29 04:18:42,935 - INFO - Plotting ticker TU with 547 data points
2025-03-29 04:18:43,775 - INFO - Time series plot saved to performance_logs/plots/TU_timeseries_LSTM-GRU_20250329_041742.png
2025-03-29 04:18:44,325 - INFO - 2D histogram for bid saved to performance_logs/plots/TU_bid_2dhist_LSTM-GRU_20250329_041742.png
2025-03-29 04:18:44,738 - INFO - 2D histogram for ask saved to performance_logs/plots/TU_ask_2dhist_LSTM-GRU_20250329_041742.png
2025-03-29 04:18:45,173 - INFO - Error distribution plot for bid saved to performance_logs/plots/TU_bid_error_dist_LSTM-GRU_20250329_041742.png
2025-03-29 04:18:45,598 - INFO - Error distribution plot for ask saved to performance_logs/plots/TU_ask_error_dist_LSTM-GRU_20250329_041742.png
2025-03-29 04:18:45,599 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_TU_20250329_041742.txt
2025-03-29 04:18:45,599 - INFO - Extended training complete. Log: performance_logs/LSTM-GRU_TU_20250329_041742.txt
2025-03-29 04:18:45,599 - INFO - Saving model and results...
2025-03-29 04:18:45,611 - INFO - Model saved to models/HybridRNN_TU_target_bid-ask_20250329_041845.pth
2025-03-29 04:18:45,986 - INFO - Training plot saved to plots/training_plot_TU_bid-ask_20250329_041845.png
2025-03-29 04:18:45,987 - INFO - Plotting ticker TU with 547 data points
2025-03-29 04:18:46,714 - INFO - Time series plot saved to plots/TU_timeseries_test_set_20250329_041845.png
2025-03-29 04:18:47,131 - INFO - 2D histogram for bid saved to plots/TU_bid_2dhist_test_set_20250329_041845.png
2025-03-29 04:18:47,539 - INFO - 2D histogram for ask saved to plots/TU_ask_2dhist_test_set_20250329_041845.png
2025-03-29 04:18:47,974 - INFO - Error distribution plot for bid saved to plots/TU_bid_error_dist_test_set_20250329_041845.png
2025-03-29 04:18:48,396 - INFO - Error distribution plot for ask saved to plots/TU_ask_error_dist_test_set_20250329_041845.png
2025-03-29 04:18:48,397 - INFO - Model training workflow completed successfully.
2025-03-29 04:22:25,939 - INFO - Application terminated by user choice
2025-03-29 04:22:25,939 - INFO - Application shutdown sequence finished.
2025-03-29 04:22:37,205 - INFO - Starting Option Trading Model application
2025-03-29 04:22:37,205 - INFO - Loading configuration...
2025-03-29 04:22:37,226 - INFO - Running in local environment.
2025-03-29 04:22:37,227 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 04:22:37,227 - INFO - Configuration loaded:
2025-03-29 04:22:37,227 - INFO -   seq_len: 30
2025-03-29 04:22:37,227 - INFO -   batch_size: 48
2025-03-29 04:22:37,227 - INFO -   epochs: 20
2025-03-29 04:22:37,227 - INFO -   lr: 0.001
2025-03-29 04:22:37,227 - INFO -   hidden_size_lstm: 64
2025-03-29 04:22:37,227 - INFO -   hidden_size_gru: 64
2025-03-29 04:22:37,227 - INFO -   num_layers: 2
2025-03-29 04:22:37,227 - INFO -   ticker: None
2025-03-29 04:22:37,227 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 04:22:37,227 - INFO -   device: mps
2025-03-29 04:22:37,227 - INFO -   data_dir: data_files/split_data
2025-03-29 04:22:37,227 - INFO -   models_dir: models
2025-03-29 04:22:37,227 - INFO -   performance_logs_dir: performance_logs
2025-03-29 04:22:37,227 - INFO -   viz_dir: plots
2025-03-29 04:22:37,227 - INFO - Using device: mps
2025-03-29 04:22:37,227 - INFO - Checking data directory: data_files/split_data
2025-03-29 04:22:37,227 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 04:22:37,227 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 04:22:37,227 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 04:22:37,227 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 04:22:37,227 - INFO - Validated and ensured necessary directories exist.
2025-03-29 04:22:38,600 - INFO - Starting model training workflow...
2025-03-29 04:22:39,846 - INFO - Performance tracking enabled: True
2025-03-29 04:22:40,421 - INFO - Include Option Greeks features: True
2025-03-29 04:22:40,810 - INFO - Include Rolling Window features: True
2025-03-29 04:22:41,194 - INFO - Include Cyclical Date Features: True
2025-03-29 04:22:42,099 - INFO - Selected architecture: LSTM-GRU
2025-03-29 04:22:44,695 - INFO - Number of epochs set to: 4
2025-03-29 04:22:46,316 - INFO - Selected ticker for training: TU
2025-03-29 04:22:46,317 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 04:22:46,317 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 04:22:46,317 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 04:22:46,317 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 04:22:46,317 - INFO - Include Greeks: True
2025-03-29 04:22:46,317 - INFO - Include Rolling Features: True
2025-03-29 04:22:46,317 - INFO - Include Cyclical Date Features: True
2025-03-29 04:22:46,356 - INFO - Starting rolling window feature computation...
2025-03-29 04:22:46,379 - INFO - Generated 108 rolling features.
2025-03-29 04:22:46,379 - INFO - Including 108 rolling features.
2025-03-29 04:22:46,379 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 04:22:46,379 - INFO - Including 6 cyclical date features.
2025-03-29 04:22:46,384 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 04:22:46,386 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 04:22:46,386 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 04:22:46,387 - INFO - Number of features used: 139
2025-03-29 04:22:46,388 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 04:22:46,388 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 04:22:46,401 - INFO - Analyzing model architecture...
2025-03-29 04:22:46,401 - INFO - Analyzing architecture on device: mps:0
2025-03-29 04:22:46,521 - INFO - Model analysis complete: Total Params=138360
2025-03-29 04:22:46,521 - INFO - Starting training with performance tracking...
2025-03-29 04:22:46,521 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 04:22:46,521 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 04:22:46,522 - INFO - Performance log: performance_logs/LSTM-GRU_TU_20250329_042246.txt
2025-03-29 04:23:21,603 - INFO - Plotting ticker TU with 547 data points
2025-03-29 04:23:22,433 - INFO - Time series plot saved to performance_logs/plots/TU_timeseries_LSTM-GRU_20250329_042246.png
2025-03-29 04:23:22,987 - INFO - 2D histogram for bid saved to performance_logs/plots/TU_bid_2dhist_LSTM-GRU_20250329_042246.png
2025-03-29 04:23:23,397 - INFO - 2D histogram for ask saved to performance_logs/plots/TU_ask_2dhist_LSTM-GRU_20250329_042246.png
2025-03-29 04:23:23,833 - INFO - Error distribution plot for bid saved to performance_logs/plots/TU_bid_error_dist_LSTM-GRU_20250329_042246.png
2025-03-29 04:23:24,259 - INFO - Error distribution plot for ask saved to performance_logs/plots/TU_ask_error_dist_LSTM-GRU_20250329_042246.png
2025-03-29 04:23:24,260 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_TU_20250329_042246.txt
2025-03-29 04:23:24,260 - INFO - Extended training complete. Log: performance_logs/LSTM-GRU_TU_20250329_042246.txt
2025-03-29 04:23:24,260 - INFO - Saving model and results...
2025-03-29 04:23:24,272 - INFO - Model saved to models/HybridRNN_TU_target_bid-ask_20250329_042324.pth
2025-03-29 04:23:24,640 - INFO - Training plot saved to plots/training_plot_TU_bid-ask_20250329_042324.png
2025-03-29 04:23:24,641 - INFO - Plotting ticker TU with 547 data points
2025-03-29 04:23:25,363 - INFO - Time series plot saved to plots/TU_timeseries_test_set_20250329_042324.png
2025-03-29 04:23:25,778 - INFO - 2D histogram for bid saved to plots/TU_bid_2dhist_test_set_20250329_042324.png
2025-03-29 04:23:26,188 - INFO - 2D histogram for ask saved to plots/TU_ask_2dhist_test_set_20250329_042324.png
2025-03-29 04:23:26,626 - INFO - Error distribution plot for bid saved to plots/TU_bid_error_dist_test_set_20250329_042324.png
2025-03-29 04:23:27,055 - INFO - Error distribution plot for ask saved to plots/TU_ask_error_dist_test_set_20250329_042324.png
2025-03-29 04:23:27,056 - INFO - Model training workflow completed successfully.
2025-03-29 04:29:58,187 - INFO - Application terminated by user choice
2025-03-29 04:29:58,187 - INFO - Application shutdown sequence finished.
2025-03-29 04:30:06,233 - INFO - Starting Option Trading Model application
2025-03-29 04:30:06,233 - INFO - Loading configuration...
2025-03-29 04:30:06,254 - INFO - Running in local environment.
2025-03-29 04:30:06,254 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 04:30:06,254 - INFO - Configuration loaded:
2025-03-29 04:30:06,254 - INFO -   seq_len: 30
2025-03-29 04:30:06,254 - INFO -   batch_size: 48
2025-03-29 04:30:06,254 - INFO -   epochs: 20
2025-03-29 04:30:06,254 - INFO -   lr: 0.001
2025-03-29 04:30:06,254 - INFO -   hidden_size_lstm: 64
2025-03-29 04:30:06,254 - INFO -   hidden_size_gru: 64
2025-03-29 04:30:06,254 - INFO -   num_layers: 2
2025-03-29 04:30:06,254 - INFO -   ticker: None
2025-03-29 04:30:06,254 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 04:30:06,254 - INFO -   device: mps
2025-03-29 04:30:06,254 - INFO -   data_dir: data_files/split_data
2025-03-29 04:30:06,254 - INFO -   models_dir: models
2025-03-29 04:30:06,254 - INFO -   performance_logs_dir: performance_logs
2025-03-29 04:30:06,254 - INFO -   viz_dir: plots
2025-03-29 04:30:06,254 - INFO - Using device: mps
2025-03-29 04:30:06,254 - INFO - Checking data directory: data_files/split_data
2025-03-29 04:30:06,254 - INFO - Found 'by_ticker' subdirectory in data_files/split_data
2025-03-29 04:30:06,254 - INFO - Ensuring directory exists: models (for models_dir)
2025-03-29 04:30:06,254 - INFO - Ensuring directory exists: performance_logs (for performance_logs_dir)
2025-03-29 04:30:06,254 - INFO - Ensuring directory exists: plots (for viz_dir)
2025-03-29 04:30:06,254 - INFO - Validated and ensured necessary directories exist.
2025-03-29 04:30:07,792 - INFO - Starting model training workflow...
2025-03-29 04:30:09,114 - INFO - Performance tracking enabled: True
2025-03-29 04:30:09,419 - INFO - Include Option Greeks features: True
2025-03-29 04:30:09,731 - INFO - Include Rolling Window features: True
2025-03-29 04:30:10,158 - INFO - Include Cyclical Date Features: True
2025-03-29 04:30:11,690 - INFO - Selected architecture: LSTM-GRU
2025-03-29 04:30:14,249 - INFO - Number of epochs set to: 4
2025-03-29 04:30:16,162 - INFO - Selected ticker for training: TU
2025-03-29 04:30:16,162 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 04:30:16,162 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 04:30:16,162 - INFO - Attempting to load data from Colab path: data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 04:30:16,162 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 04:30:16,162 - INFO - Include Greeks: True
2025-03-29 04:30:16,163 - INFO - Include Rolling Features: True
2025-03-29 04:30:16,163 - INFO - Include Cyclical Date Features: True
2025-03-29 04:30:16,213 - INFO - Starting rolling window feature computation...
2025-03-29 04:30:16,236 - INFO - Generated 108 rolling features.
2025-03-29 04:30:16,236 - INFO - Including 108 rolling features.
2025-03-29 04:30:16,236 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 04:30:16,236 - INFO - Including 6 cyclical date features.
2025-03-29 04:30:16,242 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 04:30:16,244 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 04:30:16,244 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 04:30:16,245 - INFO - Number of features used: 139
2025-03-29 04:30:16,245 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 04:30:16,245 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 04:30:16,259 - INFO - Analyzing model architecture...
2025-03-29 04:30:16,260 - INFO - Analyzing architecture on device: mps:0
2025-03-29 04:30:16,380 - INFO - Model analysis complete: Total Params=138360
2025-03-29 04:30:16,380 - INFO - Starting training with performance tracking...
2025-03-29 04:30:16,380 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 04:30:16,380 - INFO - Performance logs will be saved to: performance_logs
2025-03-29 04:30:16,380 - INFO - Performance log: performance_logs/LSTM-GRU_TU_20250329_043016.txt
2025-03-29 04:30:51,478 - INFO - Plotting ticker TU with 547 data points
2025-03-29 04:30:52,313 - INFO - Time series plot saved to performance_logs/plots/TU_timeseries_LSTM-GRU_20250329_043016.png
2025-03-29 04:30:52,855 - INFO - 2D histogram for bid saved to performance_logs/plots/TU_bid_2dhist_LSTM-GRU_20250329_043016.png
2025-03-29 04:30:53,261 - INFO - 2D histogram for ask saved to performance_logs/plots/TU_ask_2dhist_LSTM-GRU_20250329_043016.png
2025-03-29 04:30:53,690 - INFO - Error distribution plot for bid saved to performance_logs/plots/TU_bid_error_dist_LSTM-GRU_20250329_043016.png
2025-03-29 04:30:54,117 - INFO - Error distribution plot for ask saved to performance_logs/plots/TU_ask_error_dist_LSTM-GRU_20250329_043016.png
2025-03-29 04:30:54,119 - INFO - Performance metrics saved to performance_logs/LSTM-GRU_TU_20250329_043016.txt
2025-03-29 04:30:54,119 - INFO - Extended training complete. Log: performance_logs/LSTM-GRU_TU_20250329_043016.txt
2025-03-29 04:30:54,119 - INFO - Saving model and results...
2025-03-29 04:30:54,130 - INFO - Model saved to models/HybridRNN_TU_target_bid-ask_20250329_043054.pth
2025-03-29 04:30:54,498 - INFO - Training plot saved to plots/training_plot_TU_bid-ask_20250329_043054.png
2025-03-29 04:30:54,499 - INFO - Plotting ticker TU with 547 data points
2025-03-29 04:30:55,222 - INFO - Time series plot saved to plots/TU_timeseries_test_set_20250329_043054.png
2025-03-29 04:30:55,628 - INFO - 2D histogram for bid saved to plots/TU_bid_2dhist_test_set_20250329_043054.png
2025-03-29 04:30:56,037 - INFO - 2D histogram for ask saved to plots/TU_ask_2dhist_test_set_20250329_043054.png
2025-03-29 04:30:56,468 - INFO - Error distribution plot for bid saved to plots/TU_bid_error_dist_test_set_20250329_043054.png
2025-03-29 04:30:56,893 - INFO - Error distribution plot for ask saved to plots/TU_ask_error_dist_test_set_20250329_043054.png
2025-03-29 04:30:56,894 - INFO - Model training workflow completed successfully.
2025-03-29 04:31:42,416 - INFO - Application terminated by user choice
2025-03-29 04:31:42,417 - INFO - Application shutdown sequence finished.
2025-03-29 06:10:38,305 - INFO - Starting Option Trading Model application
2025-03-29 06:10:38,305 - INFO - Loading configuration...
2025-03-29 06:10:38,327 - INFO - Running in local environment.
2025-03-29 06:10:38,327 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 06:10:38,327 - INFO - Configuration loaded:
2025-03-29 06:10:38,327 - INFO -   seq_len: 30
2025-03-29 06:10:38,327 - INFO -   batch_size: 48
2025-03-29 06:10:38,327 - INFO -   epochs: 20
2025-03-29 06:10:38,327 - INFO -   lr: 0.001
2025-03-29 06:10:38,327 - INFO -   hidden_size_lstm: 64
2025-03-29 06:10:38,327 - INFO -   hidden_size_gru: 64
2025-03-29 06:10:38,327 - INFO -   num_layers: 2
2025-03-29 06:10:38,327 - INFO -   ticker: None
2025-03-29 06:10:38,327 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 06:10:38,327 - INFO -   device: mps
2025-03-29 06:10:38,327 - INFO -   data_dir: /Users/bekheet/dev/option-ml-prediction/data_files/split_data
2025-03-29 06:10:38,327 - INFO -   models_dir: /Users/bekheet/dev/option-ml-prediction/models
2025-03-29 06:10:38,327 - INFO -   performance_logs_dir: /Users/bekheet/dev/option-ml-prediction/performance_logs
2025-03-29 06:10:38,327 - INFO -   viz_dir: /Users/bekheet/dev/option-ml-prediction/plots
2025-03-29 06:10:38,327 - INFO - Using device: mps
2025-03-29 06:10:38,327 - INFO - Checking data directory: /Users/bekheet/dev/option-ml-prediction/data_files/split_data
2025-03-29 06:10:38,327 - INFO - Found 'by_ticker' subdirectory in /Users/bekheet/dev/option-ml-prediction/data_files/split_data
2025-03-29 06:10:38,327 - INFO - Ensuring directory exists: /Users/bekheet/dev/option-ml-prediction/models (for models_dir)
2025-03-29 06:10:38,327 - INFO - Ensuring directory exists: /Users/bekheet/dev/option-ml-prediction/performance_logs (for performance_logs_dir)
2025-03-29 06:10:38,327 - INFO - Ensuring directory exists: /Users/bekheet/dev/option-ml-prediction/plots (for viz_dir)
2025-03-29 06:10:38,327 - INFO - Validated and ensured necessary directories exist.
2025-03-29 06:10:45,279 - INFO - Starting model training workflow...
2025-03-29 06:10:46,500 - INFO - Performance tracking enabled: True
2025-03-29 06:10:46,691 - INFO - Include Option Greeks features: True
2025-03-29 06:10:46,891 - INFO - Include Rolling Window features: True
2025-03-29 06:10:47,874 - INFO - Include Cyclical Date Features: True
2025-03-29 06:10:49,093 - INFO - Selected architecture: LSTM-GRU
2025-03-29 06:10:51,049 - INFO - Number of epochs set to: 3
2025-03-29 06:10:52,681 - INFO - Selected ticker for training: TU
2025-03-29 06:10:52,682 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 06:10:52,682 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 06:10:52,682 - INFO - Attempting to load data from Colab path: /Users/bekheet/dev/option-ml-prediction/data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 06:10:52,682 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 06:10:52,682 - INFO - Include Greeks: True
2025-03-29 06:10:52,682 - INFO - Include Rolling Features: True
2025-03-29 06:10:52,683 - INFO - Include Cyclical Date Features: True
2025-03-29 06:10:52,722 - INFO - Starting rolling window feature computation...
2025-03-29 06:10:52,746 - INFO - Generated 108 rolling features.
2025-03-29 06:10:52,746 - INFO - Including 108 rolling features.
2025-03-29 06:10:52,747 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 06:10:52,747 - INFO - Including 6 cyclical date features.
2025-03-29 06:10:52,752 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 06:10:52,754 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 06:10:52,754 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 06:10:52,755 - INFO - Number of features used: 139
2025-03-29 06:10:52,755 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 06:10:52,755 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 06:10:52,769 - INFO - Analyzing model architecture...
2025-03-29 06:10:52,769 - INFO - Analyzing architecture on device: mps:0
2025-03-29 06:10:52,896 - INFO - Model analysis complete: Total Params=138360
2025-03-29 06:10:52,896 - INFO - Starting training with performance tracking...
2025-03-29 06:10:52,896 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 06:10:52,896 - INFO - Performance logs will be saved to: /Users/bekheet/dev/option-ml-prediction/performance_logs
2025-03-29 06:10:52,896 - INFO - Performance log: /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_TU_20250329_061052.txt
2025-03-29 06:11:20,239 - INFO - Plotting ticker TU with 547 data points
2025-03-29 06:11:21,110 - INFO - Time series plot saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_timeseries_LSTM-GRU_20250329_061052.png
2025-03-29 06:11:21,669 - INFO - 2D histogram for bid saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_bid_2dhist_LSTM-GRU_20250329_061052.png
2025-03-29 06:11:22,088 - INFO - 2D histogram for ask saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_ask_2dhist_LSTM-GRU_20250329_061052.png
2025-03-29 06:11:22,528 - INFO - Error distribution plot for bid saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_bid_error_dist_LSTM-GRU_20250329_061052.png
2025-03-29 06:11:22,977 - INFO - Error distribution plot for ask saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_ask_error_dist_LSTM-GRU_20250329_061052.png
2025-03-29 06:11:22,978 - INFO - Performance metrics saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_TU_20250329_061052.txt
2025-03-29 06:11:22,978 - INFO - Extended training complete. Log: /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_TU_20250329_061052.txt
2025-03-29 06:11:22,978 - INFO - Saving model and results...
2025-03-29 06:11:22,990 - INFO - Model saved to /Users/bekheet/dev/option-ml-prediction/models/HybridRNN_TU_target_bid-ask_20250329_061122.pth
2025-03-29 06:11:23,367 - INFO - Training plot saved to /Users/bekheet/dev/option-ml-prediction/plots/training_plot_TU_bid-ask_20250329_061122.png
2025-03-29 06:11:23,368 - ERROR - Failed to generate prediction plot from history: DEBUG: Reached the start of the MODIFIED load_scaling_params function!
Traceback (most recent call last):
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/visualization_utils.py", line 92, in save_and_display_results
    scaling_params = load_scaling_params(ticker, data_dir)
  File "/Users/bekheet/dev/option-ml-prediction/src/utils/model_utils.py", line 417, in load_scaling_params
    raise Exception("DEBUG: Reached the start of the MODIFIED load_scaling_params function!")
Exception: DEBUG: Reached the start of the MODIFIED load_scaling_params function!
2025-03-29 06:11:23,368 - INFO - Model training workflow completed successfully.
2025-03-29 06:14:28,887 - INFO - Application terminated by user choice
2025-03-29 06:14:28,887 - INFO - Application shutdown sequence finished.
2025-03-29 06:14:33,123 - INFO - Starting Option Trading Model application
2025-03-29 06:14:33,123 - INFO - Loading configuration...
2025-03-29 06:14:33,143 - INFO - Running in local environment.
2025-03-29 06:14:33,143 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 06:14:33,143 - INFO - Configuration loaded:
2025-03-29 06:14:33,143 - INFO -   seq_len: 30
2025-03-29 06:14:33,143 - INFO -   batch_size: 48
2025-03-29 06:14:33,143 - INFO -   epochs: 20
2025-03-29 06:14:33,143 - INFO -   lr: 0.001
2025-03-29 06:14:33,143 - INFO -   hidden_size_lstm: 64
2025-03-29 06:14:33,143 - INFO -   hidden_size_gru: 64
2025-03-29 06:14:33,144 - INFO -   num_layers: 2
2025-03-29 06:14:33,144 - INFO -   ticker: None
2025-03-29 06:14:33,144 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 06:14:33,144 - INFO -   device: mps
2025-03-29 06:14:33,144 - INFO -   data_dir: /Users/bekheet/dev/option-ml-prediction/data_files/split_data
2025-03-29 06:14:33,144 - INFO -   models_dir: /Users/bekheet/dev/option-ml-prediction/models
2025-03-29 06:14:33,144 - INFO -   performance_logs_dir: /Users/bekheet/dev/option-ml-prediction/performance_logs
2025-03-29 06:14:33,144 - INFO -   viz_dir: /Users/bekheet/dev/option-ml-prediction/plots
2025-03-29 06:14:33,144 - INFO - Using device: mps
2025-03-29 06:14:33,144 - INFO - Checking data directory: /Users/bekheet/dev/option-ml-prediction/data_files/split_data
2025-03-29 06:14:33,144 - INFO - Found 'by_ticker' subdirectory in /Users/bekheet/dev/option-ml-prediction/data_files/split_data
2025-03-29 06:14:33,144 - INFO - Ensuring directory exists: /Users/bekheet/dev/option-ml-prediction/models (for models_dir)
2025-03-29 06:14:33,144 - INFO - Ensuring directory exists: /Users/bekheet/dev/option-ml-prediction/performance_logs (for performance_logs_dir)
2025-03-29 06:14:33,144 - INFO - Ensuring directory exists: /Users/bekheet/dev/option-ml-prediction/plots (for viz_dir)
2025-03-29 06:14:33,144 - INFO - Validated and ensured necessary directories exist.
2025-03-29 06:14:34,873 - INFO - Starting model training workflow...
2025-03-29 06:14:36,137 - INFO - Performance tracking enabled: True
2025-03-29 06:14:36,343 - INFO - Include Option Greeks features: True
2025-03-29 06:14:36,595 - INFO - Include Rolling Window features: True
2025-03-29 06:14:37,130 - INFO - Include Cyclical Date Features: True
2025-03-29 06:14:38,265 - INFO - Selected architecture: LSTM-GRU
2025-03-29 06:14:40,118 - INFO - Number of epochs set to: 3
2025-03-29 06:14:41,617 - INFO - Selected ticker for training: TU
2025-03-29 06:14:41,618 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 06:14:41,618 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 06:14:41,618 - INFO - Attempting to load data from Colab path: /Users/bekheet/dev/option-ml-prediction/data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 06:14:41,618 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 06:14:41,618 - INFO - Include Greeks: True
2025-03-29 06:14:41,618 - INFO - Include Rolling Features: True
2025-03-29 06:14:41,618 - INFO - Include Cyclical Date Features: True
2025-03-29 06:14:41,656 - INFO - Starting rolling window feature computation...
2025-03-29 06:14:41,678 - INFO - Generated 108 rolling features.
2025-03-29 06:14:41,678 - INFO - Including 108 rolling features.
2025-03-29 06:14:41,678 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 06:14:41,678 - INFO - Including 6 cyclical date features.
2025-03-29 06:14:41,684 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 06:14:41,686 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 06:14:41,686 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 06:14:41,686 - INFO - Number of features used: 139
2025-03-29 06:14:41,687 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 06:14:41,687 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 06:14:41,699 - INFO - Analyzing model architecture...
2025-03-29 06:14:41,700 - INFO - Analyzing architecture on device: mps:0
2025-03-29 06:14:41,827 - INFO - Model analysis complete: Total Params=138360
2025-03-29 06:14:41,827 - INFO - Starting training with performance tracking...
2025-03-29 06:14:41,827 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 06:14:41,827 - INFO - Performance logs will be saved to: /Users/bekheet/dev/option-ml-prediction/performance_logs
2025-03-29 06:14:41,827 - INFO - Performance log: /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_TU_20250329_061441.txt
2025-03-29 06:15:09,507 - INFO - Plotting ticker TU with 547 data points
2025-03-29 06:15:10,359 - INFO - Time series plot saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_timeseries_LSTM-GRU_20250329_061441.png
2025-03-29 06:15:10,918 - INFO - 2D histogram for bid saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_bid_2dhist_LSTM-GRU_20250329_061441.png
2025-03-29 06:15:11,336 - INFO - 2D histogram for ask saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_ask_2dhist_LSTM-GRU_20250329_061441.png
2025-03-29 06:15:11,777 - INFO - Error distribution plot for bid saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_bid_error_dist_LSTM-GRU_20250329_061441.png
2025-03-29 06:15:12,214 - INFO - Error distribution plot for ask saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_ask_error_dist_LSTM-GRU_20250329_061441.png
2025-03-29 06:15:12,215 - INFO - Performance metrics saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_TU_20250329_061441.txt
2025-03-29 06:15:12,215 - INFO - Extended training complete. Log: /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_TU_20250329_061441.txt
2025-03-29 06:15:12,215 - INFO - Saving model and results...
2025-03-29 06:15:12,227 - INFO - Model saved to /Users/bekheet/dev/option-ml-prediction/models/HybridRNN_TU_target_bid-ask_20250329_061512.pth
2025-03-29 06:15:12,605 - INFO - Training plot saved to /Users/bekheet/dev/option-ml-prediction/plots/training_plot_TU_bid-ask_20250329_061512.png
2025-03-29 06:15:12,605 - INFO - Attempting to load scaling parameters from constructed path: /Users/bekheet/dev/option-ml-prediction/data_files/split_data/by_ticker/scaling_params/TU_scaling_params.json
2025-03-29 06:15:12,606 - INFO - Successfully loaded and parsed scaling parameters for TU.
2025-03-29 06:15:12,606 - INFO - Recovering original values for columns: ['bid', 'ask']
2025-03-29 06:15:12,606 - INFO - Recovering original values for columns: ['bid', 'ask']
2025-03-29 06:15:12,607 - INFO - Plotting ticker TU with 547 data points
2025-03-29 06:15:13,348 - INFO - Time series plot saved to /Users/bekheet/dev/option-ml-prediction/plots/TU_timeseries_test_set_20250329_061512.png
2025-03-29 06:15:13,776 - INFO - 2D histogram for bid saved to /Users/bekheet/dev/option-ml-prediction/plots/TU_bid_2dhist_test_set_20250329_061512.png
2025-03-29 06:15:14,192 - INFO - 2D histogram for ask saved to /Users/bekheet/dev/option-ml-prediction/plots/TU_ask_2dhist_test_set_20250329_061512.png
2025-03-29 06:15:14,640 - INFO - Error distribution plot for bid saved to /Users/bekheet/dev/option-ml-prediction/plots/TU_bid_error_dist_test_set_20250329_061512.png
2025-03-29 06:15:15,081 - INFO - Error distribution plot for ask saved to /Users/bekheet/dev/option-ml-prediction/plots/TU_ask_error_dist_test_set_20250329_061512.png
2025-03-29 06:15:15,082 - INFO - Model training workflow completed successfully.
2025-03-29 06:15:32,335 - INFO - Starting model training workflow...
2025-03-29 06:15:33,361 - INFO - Performance tracking enabled: True
2025-03-29 06:15:33,579 - INFO - Include Option Greeks features: True
2025-03-29 06:15:33,841 - INFO - Include Rolling Window features: True
2025-03-29 06:15:34,164 - INFO - Include Cyclical Date Features: True
2025-03-29 06:15:34,930 - INFO - Selected architecture: LSTM-GRU
2025-03-29 06:15:35,528 - INFO - Number of epochs set to: 20
2025-03-29 06:16:06,261 - INFO - Selected ticker for training: KSU
2025-03-29 06:16:06,261 - INFO - Initializing dataset for KSU, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 06:16:06,261 - INFO - Initializing StockOptionDataset for ticker: KSU
2025-03-29 06:16:06,261 - INFO - Attempting to load data from Colab path: /Users/bekheet/dev/option-ml-prediction/data_files/split_data/by_ticker/KSU_normalized.csv
2025-03-29 06:16:06,261 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 06:16:06,261 - INFO - Include Greeks: True
2025-03-29 06:16:06,261 - INFO - Include Rolling Features: True
2025-03-29 06:16:06,261 - INFO - Include Cyclical Date Features: True
2025-03-29 06:16:06,264 - INFO - Starting rolling window feature computation...
2025-03-29 06:16:06,270 - INFO - Generated 108 rolling features.
2025-03-29 06:16:06,270 - INFO - Including 108 rolling features.
2025-03-29 06:16:06,270 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 06:16:06,270 - INFO - Including 6 cyclical date features.
2025-03-29 06:16:06,271 - INFO - Dropped 0 rows (0.00%) due to NaNs in needed columns.
2025-03-29 06:16:06,271 - INFO - Dataset created for KSU: Features=139, Targets=2, Samples=89, MaxIdx=58
2025-03-29 06:16:06,271 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 06:16:06,272 - INFO - Number of features used: 139
2025-03-29 06:16:06,272 - INFO - DataLoaders created: Train=47, Val=5, Test=7 samples. Settings: workers=0, pin_mem=False
2025-03-29 06:16:06,272 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 06:16:06,282 - INFO - Analyzing model architecture...
2025-03-29 06:16:06,283 - INFO - Analyzing architecture on device: mps:0
2025-03-29 06:16:06,312 - INFO - Model analysis complete: Total Params=138360
2025-03-29 06:16:06,313 - INFO - Starting training with performance tracking...
2025-03-29 06:16:06,313 - INFO - Initiating extended training with tracking for KSU - LSTM-GRU
2025-03-29 06:16:06,313 - INFO - Performance logs will be saved to: /Users/bekheet/dev/option-ml-prediction/performance_logs
2025-03-29 06:16:06,313 - INFO - Performance log: /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_KSU_20250329_061606.txt
2025-03-29 06:16:10,074 - INFO - Plotting ticker KSU with 7 data points
2025-03-29 06:16:10,818 - INFO - Time series plot saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/KSU_timeseries_LSTM-GRU_20250329_061606.png
2025-03-29 06:16:11,245 - INFO - 2D histogram for bid saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/KSU_bid_2dhist_LSTM-GRU_20250329_061606.png
2025-03-29 06:16:11,673 - INFO - 2D histogram for ask saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/KSU_ask_2dhist_LSTM-GRU_20250329_061606.png
2025-03-29 06:16:12,098 - INFO - Error distribution plot for bid saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/KSU_bid_error_dist_LSTM-GRU_20250329_061606.png
2025-03-29 06:16:12,507 - INFO - Error distribution plot for ask saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/KSU_ask_error_dist_LSTM-GRU_20250329_061606.png
2025-03-29 06:16:12,509 - INFO - Performance metrics saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_KSU_20250329_061606.txt
2025-03-29 06:16:12,509 - INFO - Extended training complete. Log: /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_KSU_20250329_061606.txt
2025-03-29 06:16:12,509 - INFO - Saving model and results...
2025-03-29 06:16:12,520 - INFO - Model saved to /Users/bekheet/dev/option-ml-prediction/models/HybridRNN_KSU_target_bid-ask_20250329_061612.pth
2025-03-29 06:16:12,904 - INFO - Training plot saved to /Users/bekheet/dev/option-ml-prediction/plots/training_plot_KSU_bid-ask_20250329_061612.png
2025-03-29 06:16:12,904 - INFO - Attempting to load scaling parameters from constructed path: /Users/bekheet/dev/option-ml-prediction/data_files/split_data/by_ticker/scaling_params/KSU_scaling_params.json
2025-03-29 06:16:12,904 - INFO - Successfully loaded and parsed scaling parameters for KSU.
2025-03-29 06:16:12,904 - INFO - Recovering original values for columns: ['bid', 'ask']
2025-03-29 06:16:12,904 - INFO - Recovering original values for columns: ['bid', 'ask']
2025-03-29 06:16:12,905 - INFO - Plotting ticker KSU with 7 data points
2025-03-29 06:16:13,580 - INFO - Time series plot saved to /Users/bekheet/dev/option-ml-prediction/plots/KSU_timeseries_test_set_20250329_061612.png
2025-03-29 06:16:14,002 - INFO - 2D histogram for bid saved to /Users/bekheet/dev/option-ml-prediction/plots/KSU_bid_2dhist_test_set_20250329_061612.png
2025-03-29 06:16:14,432 - INFO - 2D histogram for ask saved to /Users/bekheet/dev/option-ml-prediction/plots/KSU_ask_2dhist_test_set_20250329_061612.png
2025-03-29 06:16:14,855 - INFO - Error distribution plot for bid saved to /Users/bekheet/dev/option-ml-prediction/plots/KSU_bid_error_dist_test_set_20250329_061612.png
2025-03-29 06:16:15,281 - INFO - Error distribution plot for ask saved to /Users/bekheet/dev/option-ml-prediction/plots/KSU_ask_error_dist_test_set_20250329_061612.png
2025-03-29 06:16:15,282 - INFO - Model training workflow completed successfully.
2025-03-29 06:16:26,599 - INFO - Starting model training workflow...
2025-03-29 06:16:27,474 - INFO - Performance tracking enabled: True
2025-03-29 06:16:27,689 - INFO - Include Option Greeks features: True
2025-03-29 06:16:27,896 - INFO - Include Rolling Window features: True
2025-03-29 06:16:28,083 - INFO - Include Cyclical Date Features: True
2025-03-29 06:16:29,011 - INFO - Selected architecture: LSTM-GRU
2025-03-29 06:16:31,306 - INFO - Number of epochs set to: 4
2025-03-29 06:16:35,081 - INFO - Selected ticker for training: RCI
2025-03-29 06:16:35,081 - INFO - Initializing dataset for RCI, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 06:16:35,081 - INFO - Initializing StockOptionDataset for ticker: RCI
2025-03-29 06:16:35,081 - INFO - Attempting to load data from Colab path: /Users/bekheet/dev/option-ml-prediction/data_files/split_data/by_ticker/RCI_normalized.csv
2025-03-29 06:16:35,081 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 06:16:35,081 - INFO - Include Greeks: True
2025-03-29 06:16:35,081 - INFO - Include Rolling Features: True
2025-03-29 06:16:35,081 - INFO - Include Cyclical Date Features: True
2025-03-29 06:16:35,109 - INFO - Starting rolling window feature computation...
2025-03-29 06:16:35,128 - INFO - Generated 108 rolling features.
2025-03-29 06:16:35,128 - INFO - Including 108 rolling features.
2025-03-29 06:16:35,128 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 06:16:35,128 - INFO - Including 6 cyclical date features.
2025-03-29 06:16:35,132 - INFO - Dropped 1910 rows (34.87%) due to NaNs in needed columns.
2025-03-29 06:16:35,133 - INFO - Dataset created for RCI: Features=139, Targets=2, Samples=3567, MaxIdx=3536
2025-03-29 06:16:35,133 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 06:16:35,134 - INFO - Number of features used: 139
2025-03-29 06:16:35,134 - INFO - DataLoaders created: Train=2829, Val=353, Test=355 samples. Settings: workers=0, pin_mem=False
2025-03-29 06:16:35,134 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 06:16:35,144 - INFO - Analyzing model architecture...
2025-03-29 06:16:35,144 - INFO - Analyzing architecture on device: mps:0
2025-03-29 06:16:35,174 - INFO - Model analysis complete: Total Params=138360
2025-03-29 06:16:35,174 - INFO - Starting training with performance tracking...
2025-03-29 06:16:35,174 - INFO - Initiating extended training with tracking for RCI - LSTM-GRU
2025-03-29 06:16:35,174 - INFO - Performance logs will be saved to: /Users/bekheet/dev/option-ml-prediction/performance_logs
2025-03-29 06:16:35,174 - INFO - Performance log: /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_RCI_20250329_061635.txt
2025-03-29 06:16:59,504 - INFO - Plotting ticker RCI with 355 data points
2025-03-29 06:17:00,404 - INFO - Time series plot saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/RCI_timeseries_LSTM-GRU_20250329_061635.png
2025-03-29 06:17:00,813 - INFO - 2D histogram for bid saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/RCI_bid_2dhist_LSTM-GRU_20250329_061635.png
2025-03-29 06:17:01,220 - INFO - 2D histogram for ask saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/RCI_ask_2dhist_LSTM-GRU_20250329_061635.png
2025-03-29 06:17:01,667 - INFO - Error distribution plot for bid saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/RCI_bid_error_dist_LSTM-GRU_20250329_061635.png
2025-03-29 06:17:02,114 - INFO - Error distribution plot for ask saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/RCI_ask_error_dist_LSTM-GRU_20250329_061635.png
2025-03-29 06:17:02,116 - INFO - Performance metrics saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_RCI_20250329_061635.txt
2025-03-29 06:17:02,116 - INFO - Extended training complete. Log: /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_RCI_20250329_061635.txt
2025-03-29 06:17:02,116 - INFO - Saving model and results...
2025-03-29 06:17:02,127 - INFO - Model saved to /Users/bekheet/dev/option-ml-prediction/models/HybridRNN_RCI_target_bid-ask_20250329_061702.pth
2025-03-29 06:17:02,503 - INFO - Training plot saved to /Users/bekheet/dev/option-ml-prediction/plots/training_plot_RCI_bid-ask_20250329_061702.png
2025-03-29 06:17:02,503 - INFO - Attempting to load scaling parameters from constructed path: /Users/bekheet/dev/option-ml-prediction/data_files/split_data/by_ticker/scaling_params/RCI_scaling_params.json
2025-03-29 06:17:02,504 - INFO - Successfully loaded and parsed scaling parameters for RCI.
2025-03-29 06:17:02,504 - INFO - Recovering original values for columns: ['bid', 'ask']
2025-03-29 06:17:02,504 - INFO - Recovering original values for columns: ['bid', 'ask']
2025-03-29 06:17:02,504 - INFO - Plotting ticker RCI with 355 data points
2025-03-29 06:17:03,318 - INFO - Time series plot saved to /Users/bekheet/dev/option-ml-prediction/plots/RCI_timeseries_test_set_20250329_061702.png
2025-03-29 06:17:03,738 - INFO - 2D histogram for bid saved to /Users/bekheet/dev/option-ml-prediction/plots/RCI_bid_2dhist_test_set_20250329_061702.png
2025-03-29 06:17:04,152 - INFO - 2D histogram for ask saved to /Users/bekheet/dev/option-ml-prediction/plots/RCI_ask_2dhist_test_set_20250329_061702.png
2025-03-29 06:17:04,591 - INFO - Error distribution plot for bid saved to /Users/bekheet/dev/option-ml-prediction/plots/RCI_bid_error_dist_test_set_20250329_061702.png
2025-03-29 06:17:05,129 - INFO - Error distribution plot for ask saved to /Users/bekheet/dev/option-ml-prediction/plots/RCI_ask_error_dist_test_set_20250329_061702.png
2025-03-29 06:17:05,130 - INFO - Model training workflow completed successfully.
2025-03-29 06:24:31,279 - INFO - Application terminated by user choice
2025-03-29 06:24:31,279 - INFO - Application shutdown sequence finished.
2025-03-29 06:24:35,719 - INFO - Starting Option Trading Model application
2025-03-29 06:24:35,719 - INFO - Loading configuration...
2025-03-29 06:24:35,741 - INFO - Running in local environment.
2025-03-29 06:24:35,742 - INFO - Apple Silicon MPS detected. Setting batch size to 48
2025-03-29 06:24:35,742 - INFO - Configuration loaded:
2025-03-29 06:24:35,742 - INFO -   seq_len: 30
2025-03-29 06:24:35,742 - INFO -   batch_size: 48
2025-03-29 06:24:35,742 - INFO -   epochs: 20
2025-03-29 06:24:35,742 - INFO -   lr: 0.001
2025-03-29 06:24:35,742 - INFO -   hidden_size_lstm: 64
2025-03-29 06:24:35,742 - INFO -   hidden_size_gru: 64
2025-03-29 06:24:35,742 - INFO -   num_layers: 2
2025-03-29 06:24:35,742 - INFO -   ticker: None
2025-03-29 06:24:35,742 - INFO -   target_cols: ['bid', 'ask']
2025-03-29 06:24:35,742 - INFO -   device: mps
2025-03-29 06:24:35,742 - INFO -   data_dir: /Users/bekheet/dev/option-ml-prediction/data_files/split_data
2025-03-29 06:24:35,742 - INFO -   models_dir: /Users/bekheet/dev/option-ml-prediction/models
2025-03-29 06:24:35,742 - INFO -   performance_logs_dir: /Users/bekheet/dev/option-ml-prediction/performance_logs
2025-03-29 06:24:35,742 - INFO -   viz_dir: /Users/bekheet/dev/option-ml-prediction/plots
2025-03-29 06:24:35,742 - INFO - Using device: mps
2025-03-29 06:24:35,742 - INFO - Checking data directory: /Users/bekheet/dev/option-ml-prediction/data_files/split_data
2025-03-29 06:24:35,742 - INFO - Found 'by_ticker' subdirectory in /Users/bekheet/dev/option-ml-prediction/data_files/split_data
2025-03-29 06:24:35,742 - INFO - Ensuring directory exists: /Users/bekheet/dev/option-ml-prediction/models (for models_dir)
2025-03-29 06:24:35,742 - INFO - Ensuring directory exists: /Users/bekheet/dev/option-ml-prediction/performance_logs (for performance_logs_dir)
2025-03-29 06:24:35,742 - INFO - Ensuring directory exists: /Users/bekheet/dev/option-ml-prediction/plots (for viz_dir)
2025-03-29 06:24:35,742 - INFO - Validated and ensured necessary directories exist.
2025-03-29 06:24:40,755 - INFO - Starting model training workflow...
2025-03-29 06:24:41,856 - INFO - Performance tracking enabled: True
2025-03-29 06:24:42,025 - INFO - Include Option Greeks features: True
2025-03-29 06:24:42,190 - INFO - Include Rolling Window features: True
2025-03-29 06:24:42,726 - INFO - Include Cyclical Date Features: True
2025-03-29 06:24:44,561 - INFO - Selected architecture: LSTM-GRU
2025-03-29 06:24:46,359 - INFO - Number of epochs set to: 4
2025-03-29 06:24:50,371 - INFO - Selected ticker for training: TU
2025-03-29 06:24:50,372 - INFO - Initializing dataset for TU, Greeks=True, Rolling=True, Cyclical=True...
2025-03-29 06:24:50,372 - INFO - Initializing StockOptionDataset for ticker: TU
2025-03-29 06:24:50,372 - INFO - Attempting to load data from Colab path: /Users/bekheet/dev/option-ml-prediction/data_files/split_data/by_ticker/TU_normalized.csv
2025-03-29 06:24:50,372 - INFO - Sequence length: 30, Target columns: ['bid', 'ask']
2025-03-29 06:24:50,372 - INFO - Include Greeks: True
2025-03-29 06:24:50,372 - INFO - Include Rolling Features: True
2025-03-29 06:24:50,372 - INFO - Include Cyclical Date Features: True
2025-03-29 06:24:50,407 - INFO - Starting rolling window feature computation...
2025-03-29 06:24:50,430 - INFO - Generated 108 rolling features.
2025-03-29 06:24:50,430 - INFO - Including 108 rolling features.
2025-03-29 06:24:50,430 - INFO - Including 5 Greek features: ['delta', 'gamma', 'vega', 'theta', 'rho']
2025-03-29 06:24:50,430 - INFO - Including 6 cyclical date features.
2025-03-29 06:24:50,436 - INFO - Dropped 917 rows (14.31%) due to NaNs in needed columns.
2025-03-29 06:24:50,438 - INFO - Dataset created for TU: Features=139, Targets=2, Samples=5491, MaxIdx=5460
2025-03-29 06:24:50,438 - INFO - Final features used (139): ['change', 'change_mean_10d', 'change_mean_3d', 'change_mean_5d', 'change_std_10d', 'change_std_3d', 'change_std_5d', 'day_of_month_cos', 'day_of_month_sin', 'day_of_week_cos', 'day_of_week_sin', 'day_of_year_cos', 'day_of_year_sin', 'daysToExpiry', 'delta', 'gamma', 'impliedVolatility', 'impliedVolatility_mean_10d', 'impliedVolatility_mean_3d', 'impliedVolatility_mean_5d', 'impliedVolatility_std_10d', 'impliedVolatility_std_3d', 'impliedVolatility_std_5d', 'lastPrice', 'lastPrice_mean_10d', 'lastPrice_mean_3d', 'lastPrice_mean_5d', 'lastPrice_std_10d', 'lastPrice_std_3d', 'lastPrice_std_5d', 'openInterest', 'openInterest_mean_10d', 'openInterest_mean_3d', 'openInterest_mean_5d', 'openInterest_std_10d', 'openInterest_std_3d', 'openInterest_std_5d', 'percentChange', 'percentChange_mean_10d', 'percentChange_mean_3d', 'percentChange_mean_5d', 'percentChange_std_10d', 'percentChange_std_3d', 'percentChange_std_5d', 'rho', 'risk_free_rate', 'stockAdjClose', 'stockAdjClose_mean_10d', 'stockAdjClose_mean_3d', 'stockAdjClose_mean_5d', 'stockAdjClose_std_10d', 'stockAdjClose_std_3d', 'stockAdjClose_std_5d', 'stockClose', 'stockClose_ewm_135d', 'stockClose_ewm_135d_mean_10d', 'stockClose_ewm_135d_mean_3d', 'stockClose_ewm_135d_mean_5d', 'stockClose_ewm_135d_std_10d', 'stockClose_ewm_135d_std_3d', 'stockClose_ewm_135d_std_5d', 'stockClose_ewm_15d', 'stockClose_ewm_15d_mean_10d', 'stockClose_ewm_15d_mean_3d', 'stockClose_ewm_15d_mean_5d', 'stockClose_ewm_15d_std_10d', 'stockClose_ewm_15d_std_3d', 'stockClose_ewm_15d_std_5d', 'stockClose_ewm_45d', 'stockClose_ewm_45d_mean_10d', 'stockClose_ewm_45d_mean_3d', 'stockClose_ewm_45d_mean_5d', 'stockClose_ewm_45d_std_10d', 'stockClose_ewm_45d_std_3d', 'stockClose_ewm_45d_std_5d', 'stockClose_ewm_5d', 'stockClose_ewm_5d_mean_10d', 'stockClose_ewm_5d_mean_3d', 'stockClose_ewm_5d_mean_5d', 'stockClose_ewm_5d_std_10d', 'stockClose_ewm_5d_std_3d', 'stockClose_ewm_5d_std_5d', 'stockClose_mean_10d', 'stockClose_mean_3d', 'stockClose_mean_5d', 'stockClose_std_10d', 'stockClose_std_3d', 'stockClose_std_5d', 'stockHigh', 'stockHigh_mean_10d', 'stockHigh_mean_3d', 'stockHigh_mean_5d', 'stockHigh_std_10d', 'stockHigh_std_3d', 'stockHigh_std_5d', 'stockLow', 'stockLow_mean_10d', 'stockLow_mean_3d', 'stockLow_mean_5d', 'stockLow_std_10d', 'stockLow_std_3d', 'stockLow_std_5d', 'stockOpen', 'stockOpen_mean_10d', 'stockOpen_mean_3d', 'stockOpen_mean_5d', 'stockOpen_std_10d', 'stockOpen_std_3d', 'stockOpen_std_5d', 'stockVolume', 'stockVolume_mean_10d', 'stockVolume_mean_3d', 'stockVolume_mean_5d', 'stockVolume_std_10d', 'stockVolume_std_3d', 'stockVolume_std_5d', 'strike', 'strikeDelta', 'strikeDelta_mean_10d', 'strikeDelta_mean_3d', 'strikeDelta_mean_5d', 'strikeDelta_std_10d', 'strikeDelta_std_3d', 'strikeDelta_std_5d', 'strike_mean_10d', 'strike_mean_3d', 'strike_mean_5d', 'strike_std_10d', 'strike_std_3d', 'strike_std_5d', 'theta', 'vega', 'volume', 'volume_mean_10d', 'volume_mean_3d', 'volume_mean_5d', 'volume_std_10d', 'volume_std_3d', 'volume_std_5d']
2025-03-29 06:24:50,439 - INFO - Number of features used: 139
2025-03-29 06:24:50,439 - INFO - DataLoaders created: Train=4368, Val=546, Test=547 samples. Settings: workers=0, pin_mem=False
2025-03-29 06:24:50,439 - INFO - Initializing LSTM-GRU (In:139, Out:2, H_LSTM:64, H_GRU:64, Layers:2) on mps
2025-03-29 06:24:50,453 - INFO - Analyzing model architecture...
2025-03-29 06:24:50,454 - INFO - Analyzing architecture on device: mps:0
2025-03-29 06:24:50,584 - INFO - Model analysis complete: Total Params=138360
2025-03-29 06:24:50,584 - INFO - Starting training with performance tracking...
2025-03-29 06:24:50,584 - INFO - Initiating extended training with tracking for TU - LSTM-GRU
2025-03-29 06:24:50,584 - INFO - Performance logs will be saved to: /Users/bekheet/dev/option-ml-prediction/performance_logs
2025-03-29 06:24:50,584 - INFO - Performance log: /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_TU_20250329_062450.txt
2025-03-29 06:25:26,445 - INFO - Plotting ticker TU with 547 data points
2025-03-29 06:25:27,305 - INFO - Time series plot saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_timeseries_LSTM-GRU_20250329_062450.png
2025-03-29 06:25:27,882 - INFO - 2D histogram for bid saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_bid_2dhist_LSTM-GRU_20250329_062450.png
2025-03-29 06:25:28,304 - INFO - 2D histogram for ask saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_ask_2dhist_LSTM-GRU_20250329_062450.png
2025-03-29 06:25:28,737 - INFO - Error distribution plot for bid saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_bid_error_dist_LSTM-GRU_20250329_062450.png
2025-03-29 06:25:29,175 - INFO - Error distribution plot for ask saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/plots/TU_ask_error_dist_LSTM-GRU_20250329_062450.png
2025-03-29 06:25:29,176 - INFO - Performance metrics saved to /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_TU_20250329_062450.txt
2025-03-29 06:25:29,177 - INFO - Extended training complete. Log: /Users/bekheet/dev/option-ml-prediction/performance_logs/LSTM-GRU_TU_20250329_062450.txt
2025-03-29 06:25:29,177 - INFO - Saving model and results...
2025-03-29 06:25:29,188 - INFO - Model saved to /Users/bekheet/dev/option-ml-prediction/models/HybridRNN_TU_target_bid-ask_20250329_062529.pth
2025-03-29 06:25:29,555 - INFO - Training plot saved to /Users/bekheet/dev/option-ml-prediction/plots/training_plot_TU_bid-ask_20250329_062529.png
2025-03-29 06:25:29,555 - INFO - Attempting to load scaling parameters from constructed path: /Users/bekheet/dev/option-ml-prediction/data_files/split_data/by_ticker/scaling_params/TU_scaling_params.json
2025-03-29 06:25:29,555 - INFO - Successfully loaded and parsed scaling parameters for TU.
2025-03-29 06:25:29,555 - INFO - Recovering original values for columns: ['bid', 'ask']
2025-03-29 06:25:29,555 - INFO - Recovering original values for columns: ['bid', 'ask']
2025-03-29 06:25:29,556 - INFO - Plotting ticker TU with 547 data points
2025-03-29 06:25:30,299 - INFO - Time series plot saved to /Users/bekheet/dev/option-ml-prediction/plots/TU_timeseries_test_set_20250329_062529.png
2025-03-29 06:25:30,728 - INFO - 2D histogram for bid saved to /Users/bekheet/dev/option-ml-prediction/plots/TU_bid_2dhist_test_set_20250329_062529.png
2025-03-29 06:25:31,142 - INFO - 2D histogram for ask saved to /Users/bekheet/dev/option-ml-prediction/plots/TU_ask_2dhist_test_set_20250329_062529.png
2025-03-29 06:25:31,579 - INFO - Error distribution plot for bid saved to /Users/bekheet/dev/option-ml-prediction/plots/TU_bid_error_dist_test_set_20250329_062529.png
2025-03-29 06:25:32,019 - INFO - Error distribution plot for ask saved to /Users/bekheet/dev/option-ml-prediction/plots/TU_ask_error_dist_test_set_20250329_062529.png
2025-03-29 06:25:32,020 - INFO - Model training workflow completed successfully.
